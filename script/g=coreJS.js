var tff={logLevel:(Number(logLevel)||logLevel==="0")?Number(logLevel):window.consoleLogLevels.LOG,baseUrl:(baseUrl)?baseUrl:window.location.href.match(/https?\:\/\/[a-z\.]+/)[0],page:(page)?''+page:'none',ketchupOptions:{errorContainer:$("<div class='ketchup-error-container'><ol></ol></div>"),initialPositionContainer:function(c,f){c.css({left:f.position().left+f.width()+15,top:f.position().top});},positionContainer:function(c,f){c.css({left:f.position().left+f.width()+15,top:f.position().top});},showContainer:function(ec){var fId=$(ec).attr('id').substr(8);var f=$('#'+fId);if(f){if(f.is('select.selectBox')){var ui=f.siblings('a.selectBox');if(ui&&ui.length){f=ui;}}else if(f.is('[type=checkbox],[type=radio]')){var ui=f.siblings('img.imageCheck');if(ui&&ui.length){f=ui;}}
var pos=f.position();if(pos){ec.css({left:pos.left+f.width()+15,top:pos.top});}}
ec.fadeIn();},fieldNameAttribute:'name'}};startConsole({'namespace':'tff','logLevel':tff.logLevel});tff.debug('Starting JS app (on page: "'+tff.page+'")');$.fx.speeds._default=500;$(document).ready(function(){$('.submitOnce').each(function(){var f=$(this);tff.debug('setting up submit once on ',f);f.submit(function(e){if(f.hasClass('disabled')){tff.debug('form already disabled',f);e.preventDefault();e.stopImmediatePropagation();return false;}else{tff.debug('disabling form/buttons',f.find(':submit, .submit'));f.addClass('disabled');tff.disableButton(f.find(':submit, .submit'));}}).bind('validationFailed.ketchup',function(){tff.debug('the validation, she has failed',f,f.find(':submit, .submit'));f.removeClass('disabled');tff.enableButton(f.find(':submit, .submit'));});});$(':text, :password').addClass('text');$('.watermark').each(function(){var a=$(this).attr('alt');if(a&&a.length){$(this).watermark(a).blur();}});$('.startHere').first().focus();tff.prefillFromRequest();tff.initConfirm();$('#nav > li:last a').addClass('lastA');$('.star-rating').each(function(){var star=$(this).attr('id').split('result')[1];var m=($(this).hasClass('form'))?36:18;tff.debug('star: '+star+' m: '+m+' = '+(star*m));$(this).css("background-position","0 -"+(star*m)+"px");});$('.star-rating.form').mouseout(function(){var originalresult=$(this).attr('id').split('result')[1];$(this).css("background-position","0 -"+(36*originalresult)+"px");});$('.star').mouseover(function(){star=$(this).index()+1;$(this).parent().css("background-position","0 -"+(36*star)+"px");});$('.star').click(function(){var id=$(this).parent().attr('id').split('rating')[1];var vote=$(this).index()+1;$(this).parent().attr('id',"rating1result"+vote).css("background-position","0 -"+(36*star)+"px");$('input[name=Rating]').val(vote);});$(':checkbox').simpleImageCheck({image:tff.baseUrl+'/images/checkbox_unchecked.png',imageChecked:tff.baseUrl+'/images/checkbox_checked.png'});$(':radio').simpleImageCheck({image:tff.baseUrl+'/images/radio_unchecked.png',imageChecked:tff.baseUrl+'/images/radio_checked.png'});$('select').selectBox();tff.addSorting();$('.goBack').click(function(e){e.preventDefault();window.history.back();});$('input.url').blur(function(){if($(this).val().length&&!/^http/.test($(this).val())){$(this).val('http://'+$(this).val());}});$('form.validate').ketchup(tff.ketchupOptions);$('body').on('fieldValidationFailed.ketchup','div.group.hasNote input, div.group select, div.group.hasNote textarea',function(){$(this).parents('.group').append($(this).siblings('.ketchup-error-container'));});$('.ketchup-error-container').hover(function(){$(this).find('.ketchupMessage').stop().fadeTo(500,1);},function(){$(this).find('.ketchupMessage').stop().fadeTo(500,0);});$('.userTable').not('.allShow').each(function(){$(this).wrap('<div class="tableWrapper" />');});$('.tableWrapper:first').addClass('show');$('.tableTitle').on('click',function(){var isShowing=$(this).next().css('display');if(isShowing=='none'){$(this).next().stop().slideDown().end().css('background-image','url(../images/notify-icon-arrowdown.png)');}else{$(this).next().stop().slideUp().end().css('background-image','url(../images/notify-icon-arrowup.png)');}});$('#pageHeaderImage').prependTo('#content');$('a[title], .toolTipBase').simpleTip();$(':button, :submit').not('.magnifier').not(".no-button").addClass('button');$('body').delegate('a.disabled','click',function(e){e.preventDefault();});var initSystemMessages=function(){if($("#messages").length){$("#messages").remove();}
var $systemMessages=$('<div id="messages"></div>').appendTo($("#content > .innerWrapper").not("#highlight").first());$systemMessages.setupNotify({noDuplicates:true,allowRemove:true,allowHide:false}).bind('add.notify',function(){tff.debug('notification added');$('#messages .notifyMsg').each(function(i){$(this).css({'z-index':(100-i),'top':'-'+(i*10)+'px'});});}).bind('rm.notify',function(){tff.debug("notification removed");$('#messages .notifyMsg').each(function(i){var self=this,$this=$(self);$this.css({'z-index':(100-i),'top':'-'+(i*10)+'px'});});});};initSystemMessages();$('body').on('click.fancybox-global','a[rel=fancybox], a.fancybox',function(e){e.preventDefault();var $this=$(this),rel=$this.attr("rel");if(rel){$this=$('a[rel="'+rel+'"]');}
$.fancybox.open($this,{maxWidth:800,width:'70%',height:'70%',openEffect:'elastic',closeEffect:'elastic',afterClose:function(){var $t=$(this);$t.find('img').fadeIn(300);}});});var initAccordion=function(){var $accordion=$(".accordion-1, .accordion-2"),open=function($item,callback){$item.each(function(){var $thisItem=$(this),$ul=$thisItem.find("ul"),$li=$ul.find("li"),liHeight=0;$li.each(function(){liHeight+=$(this).outerHeight();});$thisItem.addClass("active");TweenMax.to($ul,(0.2*$li.length),{"height":liHeight});TweenMax.staggerTo($li,0.3,{"rotationX":"0deg","scale":1,"margin-top":"0","opacity":1},.2);});},close=function($item,callback){$item.each(function(){var $thisItem=$(this),$ul=$thisItem.find("ul"),$li=$ul.find("li"),liLength=$li.length,liAr=new Array();$thisItem.removeClass("active");$ul.css({"overflow":"hidden"});TweenMax.to($ul,(0.3*(liLength+1)),{"height":0});for(var i=liLength-1;i>=0;i--){liAr.push($li[i]);}
TweenMax.staggerTo(liAr,0.3,{"rotationX":"-90deg","scale":.95,"opacity":0},.2);});};$accordion.on("click.accordion","h3",function(e){var $this=$(this),$item=$this.closest("li");if(!$item.is(".active")){open($item);}else{close($item);}});close($accordion.find("h3").closest("li"));};initAccordion();var initStickySidebar=function(){var $window=$(window),$sidebar=$(".l-container .sidebar.inner");if(!$sidebar.length){return false;}
var scrollTimeoutHandle=0,scrollTimeout=10,resizeTimeoutHandle=0,resizeTimeout=10,sidebarStartTop=$sidebar.offset().top,sidebarStartWidth=$sidebar.css("width"),doc=document.documentElement,body=document.body,sidebarOffsetTop,scrollTop,scrollObj;if($window.width()<960){return false;}
if(doc){scrollObj=doc;}
if(body){scrollObj=body;}
$window.bind("resize.sticky-sidebar",function(e){clearTimeout(resizeTimeoutHandle);resizeTimeoutHandle=setTimeout(function(){windowWidth=$window.width();if(windowWidth<960){$sidebar.css({"position":"static","width":"auto"});}},resizeTimeout);}).bind("scroll.sticky-sidebar",function(e){clearTimeout(scrollTimeoutHandle);scrollTimeoutHandle=setTimeout(function(){windowWidth=$window.width();if(windowWidth<960){return false;}
sidebarOffsetTop=$sidebar.offset().top;scrollTop=scrollObj.scrollTop;if(scrollTop>=sidebarOffsetTop){$sidebar.width($sidebar.width()).css({"position":"fixed","top":0});}else{$sidebar.css({"position":"static"});}
if(scrollTop<=sidebarStartTop){$sidebar.css({"position":"static"});}},scrollTimeout);});};initStickySidebar();$('input.date').not(".hasDatepicker").datepicker({minDate:+1});var page={"init":function(){page.popup.init();page.appButton.init();},"popup":{"options":{animateDuration:500,wrapSelector:"#footer"},"init":function(hashAr){if(!page.popup.elements){page.popup.elements={};}
var $wrap=page.popup.elements.$wrap;if(!$wrap){$wrap=page.popup.elements.$wrap=$(page.popup.options.wrapSelector);page.popup.elements.$buttons=$wrap.find(".popup-button");$wrap.on("click.footer-popup",page.popup.options.wrapSelector+" .popup-button",function(e){var $thisButton=$(this),href=$thisButton.attr("href"),$thisPopup=$(href);e.preventDefault();if($thisPopup.length){page.popup.methods.initPopup($thisPopup);}});}},"methods":{initPopup:function($thisPopup){var $wrap=page.popup.elements.$wrap,$popupButtons=page.popup.elements.$buttons;if(!$thisPopup.length){page.popup.methods.hide($wrap.find(".popup"));return;}
page.popup.methods.show($thisPopup.first());},show:function($popups,callback){if(!$popups.length){return;}
$popups.each(function(){var $this=$(this),$modal=tff.showModal("",$this,{beforeOpen:function(m){m.find('.modalOk').hide();m.find('.modalCancel').hide();},afterClose:function(m){var $popup=m.find(".popup"),href=$popup.attr("id"),$wrap=$(page.popup.options.wrapSelector),$link=$wrap.find('[href="#'+href+'"]');$popup.insertAfter($link).hide();},afterRemove:function(){}});$this.show();$modal.trigger("open");});},hide:function($popups,callback){if(!$popups.length){return;}
$popups.trigger("close.modal");}}},"appButton":{"options":{animateDuration:500,wrapSelector:".app-button-wrap"},"init":function(hashAr){if(!page.appButton.elements){page.appButton.elements={};}
var $wrap=page.appButton.elements.$wrap;if(!$wrap){$wrap=page.appButton.elements.$wrap=$(page.appButton.options.wrapSelector);page.appButton.elements.$buttons=$wrap.find(".popup-button");$wrap.on("click.appbutton-popup",page.appButton.options.wrapSelector+" .popup-button",function(e){var $thisButton=$(this),href=$thisButton.attr("href"),$thisPopup=$(href);e.preventDefault();if($thisPopup.length){page.appButton.methods.initPopup($thisPopup);}});}},"methods":{initPopup:function($thisPopup){var $wrap=page.appButton.elements.$wrap,$popupButtons=page.appButton.elements.$buttons;if(!$thisPopup.length){page.appButton.methods.hide($wrap.find(".popup"));return;}
page.appButton.methods.show($thisPopup.first());},show:function($popups,callback){if(!$popups.length){return;}
$popups.each(function(){var $this=$(this),$modal=tff.showModal("",$this,{beforeOpen:function(m){m.find('.modalOk').hide();m.find('.modalCancel').hide();},afterClose:function(m){var $appButton=m.find(".popup"),href=$appButton.attr("id"),$wrap=$(page.appButton.options.wrapSelector),$link=$wrap.find('[href="#'+href+'"]');$appButton.insertAfter($link).hide();},afterRemove:function(){}});$modal.find('input.date').datepicker({minDate:+1});$this.show();$modal.trigger("open");});},hide:function($appButton,callback){if(!$appButton.length){return;}
$appButton.trigger("close.modal");}}}};page.init();tff.startPage();});tff.startPage=function(){tff.debug('starting up page: '+tff.page);if(tff[tff.page]&&$.isFunction(tff[tff.page].start)){tff[tff.page].start();}};tff.initConfirm=function(){$("[data-confirm]").unbind("click.tff-confirm").bind("click.tff-confirm",function(e){var $target=$(e.target);if(!$target.is(".confirm-active")){tff.debug("not .confirm-active");tff.openConfirm($target);return false;}else{tff.debug("not .confirm-active (do nothing)");if($target.is("a")){var href=$target.attr("href");location.href=href;}else if($target.is('input[type="submit"]')){var $form=$target.closest("form");$form.submit();}else{console.log("neither link nor input[type=submit]");}}
return false;});};tff.openConfirm=function($target){var message=$target.attr("data-confirm"),$confirmWrap=$target.data("confirmWrap"),$confirmModal,$confirmBox,$confirmOk,$confirmCancel,$message;if(!$confirmWrap||!$confirmWrap.length){$confirmWrap=$("<div></div>").addClass("confirm-wrap").appendTo("body");$confirmModal=$("<div></div>").addClass("confirm-modal").appendTo($confirmWrap);$confirmBox=$("<div></div>").addClass("confirm-box").appendTo($confirmWrap);$message=$("<p></p>").addClass("message").text(message).appendTo($confirmBox);$confirmOk=$("<div></div>").addClass("confirm-ok").addClass("bluGrad").text("Confirm").appendTo($confirmBox);TweenMax.to($confirmModal,0,{"opacity":0});TweenMax.to($confirmBox,0,{"transformOrigin":"center top","transformPerspective":500});TweenMax.to($confirmBox,0,{"opacity":0,"y":-100,"rotationX":-45});$confirmCancel=$("<div></div>").addClass("confirm-cancel").addClass("button button-2").text("Cancel").appendTo($confirmBox);$confirmOk.bind("click",function(){$target.trigger("click");tff.closeConfirm($target);});$confirmCancel.bind("click",function(){tff.closeConfirm($target);});$confirmModal.bind("click",function(){tff.closeConfirm($target);});$target.data("confirmWrap",$confirmWrap);}else{$confirmModal=$confirmWrap.find(".confirm-modal");$confirmBox=$confirmWrap.find(".confirm-box");}
$confirmWrap.show();TweenMax.to($confirmModal,0.3,{"opacity":.8});TweenMax.to($confirmBox,0.3,{"opacity":1,"y":0,"rotationX":0});$target.addClass("confirm-active");};tff.closeConfirm=function($target){var $confirmWrap=$target.data("confirmWrap"),$confirmModal,$confirmBox;$confirmModal=$confirmWrap.find(".confirm-modal");$confirmBox=$confirmWrap.find(".confirm-box");$target.removeClass("confirm-active");TweenMax.to($confirmModal,0.3,{"opacity":0});TweenMax.to($confirmBox,0.3,{"opacity":0,"y":-100,"rotationX":-45,"onComplete":function(){$confirmWrap.hide();}});};tff.addSorting=function(){var sc=$('#orderBy').val();$('th.sortable').hover(function(){$(this).filter(':not(.sortCol)').addClass('sortDown');},function(){$(this).filter(':not(.sortCol)').removeClass('sortDown');}).click(function(e){if($('#orderBy').val()==$(this).attr('data-sort')){if($('#orderDir').val()=='ASC'){$('#orderDir').val('DESC');}else{$('#orderDir').val('ASC');}}else{$('#orderBy').val($(this).attr('data-sort'));$('#orderDir').val('ASC');}
$('.sortForm').submit();}).filter('[data-sort="'+sc+'"]').addClass('sortCol').find('.sortIcon').css('display','inline-block');if($('#orderDir').val()=='DESC'){$('.sortCol').removeClass('sortDown').addClass('sortUp');}
$('.entitySorter').change(function(){if($('#orderDir').val()=='ASC'){$('#orderDir').val('DESC');}else{$('#orderDir').val('ASC');}
$(this).parent('form').submit();});};tff.geocodeAddress=function(address,callback,mapNode){address=(address&&address.length)?address:null;mapNode=(mapNode)?$(mapNode):null;if(!mapNode||!mapNode.length){mapNode=null;}
callback=($.isFunction(callback))?callback:function(){};var gc=new google.maps.Geocoder();gc.geocode({'address':address},function(r,s){if(s==google.maps.GeocoderStatus.OK){if(mapNode){mapNode.gmap().bind('init',function(ev,map){mapNode.gmap('addMarker',{'position':r[0].geometry.location,'bounds':true});mapNode.gmap('option','zoom',17);mapNode.gmap('option','center',r[0].geometry.location);mapNode.gmap('option','zoomControl',true);});}
var loc=[];for(var l in r[0].geometry.location){if(!$.isFunction(r[0].geometry.location[l])){loc.push(r[0].geometry.location[l]);}}
callback(loc,r[0]);}else{tff.warn("Geocode was not successful for the following reason: "+s);callback(null);}});};tff.prefillFromRequest=function(data,form){if(!data){data=tff.requestParams;}
if(!data){return;}
form=(form)?$(form):null;if(!form){form=$('form[method='+tff.requestParams.formRequestMethod+'][action*="'+window.location.pathname+'"], form[method='+tff.requestParams.formRequestMethod+'][action=""]');}
if(form){var ignore=['action','MAX_FILE_SIZE','path','formRequestMethod'];tff.debug('prefilling data for form',form,data);for(n in data){if($.inArray(n,ignore)>-1){continue;}
var i=form.find('[name="'+n+'"], [name="'+n+'[]"]');if(i.is(':button, :submit')){continue;}else if(i.is(':checkbox')){if(data[n]){i.attr('checked','checked').trigger("change");}
else{i.removeAttr('checked').trigger("change");}}else if(i.is(':radio')){if(data[n]==null){i.removeAttr('checked');}
else{i.filter('[value="'+data[n]+'"]').attr('checked','checked').trigger("change");}}else if(i.is('select')){if(i.attr('multiple')){if($.isArray(data[n])){for(q in data[n]){if(!$.isPlainObject(data[n][q])&&!$.isArray(data[n][q])){i.find('option[value="'+data[n][q]+'"]').attr('selected','selected').trigger("change");}}}else{if(typeof data[n]!="[object Object]"){i.find('option[value="'+data[n]+'"]').attr('selected','selected').trigger("change");}}}else{if(!$.isArray(data[n])&&!$.isPlainObject(data[n])){i.find('option[value="'+data[n]+'"]').attr('selected','selected').trigger("change");}}}else if(i.is(':not(:password)')&&!(/password/.test(i.attr('name').toLowerCase()))){if(i.hasClass('dateFormat-mdy')&&data[n]&&data[n].length){var d=new Date(data[n]);if(d&&d.getDate()){i.val(''+(d.getMonth()+1)+'/'+d.getDate()+'/'+d.getFullYear());}else{var m=data[n].match(/(?:^|\s*)(?:([0-9]{4})\-([0-9]{2})\-([0-9]{2})|([0-9]{2})\/([0-9]{2})\/([0-9]{4}))(?:\s*|$)/);if(m&&m[1]){i.val(m[2]+'/'+m[3]+'/'+m[1]);}else if(m&&m[4]){i.val(m[4]+'/'+m[5]+'/'+m[6]);}else{i.val(data[n]);}}}else{i.val(data[n]);}
i.trigger("change");}}}};tff.htmlEncode=function(value){return $('<div/>').text(value).html().replace(/\'/g,'&apos;').replace(/\"/g,'&quot;');};tff.htmlDecode=function(value){return $('<div/>').html(value).text();};tff.clearForm=function(f){f=$(f);if(!f||!f.length){return;}
f.find('input.text, input:file, textarea').val('');f.find('select').each(function(){$('option',this).removeAttr('selected').filter(':first').attr('selected','selected');});f.find(':checkbox, :radio').removeAttr('checked');};tff.redirect=function(u,m,to){u=(u&&u.length)?(''+u):tff.baseUrl+'/home';to=(Number(to))?to:0;if(m&&m.Message){if(/\?/.test(u)){u+='&m='+m;}else{u+='?m='+m;}}
if(to){setTimeout(function(){window.location.href=u;},to*1000);}else{window.location.href=u;}};tff.disableButton=function(n){$(n).addClass('disabled').attr('disabled','disabled');};tff.enableButton=function(n){$(n).removeClass('disabled').attr('disabled','').removeAttr('disabled');};tff.__muid=0;tff.showModal=function(t,c,o){if(!c){c='';}
if(!t){t='';}
if(!o){o={};}
var create=function(){var thisMuid=++tff.__muid;var m=$("<div id='modal_"+(thisMuid)+"' class='modal'><h3 class='modalTitle'>"+t+"</h3><div class='modalBody'></div><div class='modalActions'><input type='button' class='modalOk button blue' value='OK' /><input type='button' class='modalCancel button gray' value='Cancel' /></div></div>");var mBackground=$(".modal-background").first();var mClose=$("<div id='modal_"+(thisMuid)+"-close' class='close-button'>X</div>");mBackground=$("<div id='modal_"+(thisMuid)+"-background' class='modal-background'></div>");m.find('.modalBody').append(c);m.data("modal-background",mBackground);c.attr("data-modal",("#modal_"+thisMuid));m.unbind("close.modal").bind("close.modal",function(){var $this=$(this);close($this);});m.unbind("open.modal").bind("open.modal",function(){var $this=$(this);open($this);}).trigger("open.modal");mClose.bind("click",function(){m.trigger("close");});mBackground.bind("click",function(){m.trigger("close");});m.find('.modalCancel').click(function(){m.trigger("close");});m.append(mClose);$('body').append(m);$('body').append(mBackground);m.find('form.validate').ketchup(tff.ketchupOptions);m.find('.watermark').each(function(){var a=$(this).attr('alt');if(a&&a.length){$(this).watermark(a).blur();}});return m;};var close=function($modal){var $this=$modal,mBackground=$this.data("modal-background");$this.addClass("removing");if($.isFunction(o.beforeClose)){o.beforeClose($this);}
mBackground.fadeOut(100,function(){});TweenMax.to($this,.1,{"scale":1.1,"opacity":0,onComplete:function(){var $t=$this;if($.isFunction(o.afterClose)){o.afterClose($t);}
$t.closest(".modal").remove();mBackground.remove();if($.isFunction(o.afterRemove)){o.afterRemove();}}});};var open=function($modal){var $this=$modal,mBackground=$this.data("modal-background"),$otherModals=$(".modal").not($this);$otherModals.trigger("close.modal");if($.isFunction(o.beforeOpen)){o.beforeOpen($this);}
mBackground.fadeIn(100);$modal.css({"opacity":0,"scale":1.1}).show();TweenMax.to($modal,(.1),{"scale":1,"opacity":1,onComplete:function(){var $t=$this;if($.isFunction(o.afterOpen)){o.afterOpen($t);}
if($.isFunction(o.init)){o.init($t);}}});};var $ret=create();return $ret;};tff.pageTable=function($section,$wrap,$table,url,pagingVar,pageTo){var $tableWrap=$wrap,currentPage=parseInt($tableWrap.attr("data-currentpage")),$section=$section,$loader=$section.find(".loader"),$paginationWrap=$section.find(".pagination-wrap"),$pagination=$paginationWrap.find(".paging"),$searchBox=$section.find(".table-search"),listType=$table.attr("data-listtype"),sortBy=$wrap.attr("sortBy"),sortDir=$wrap.attr("sortDir"),dataOut={api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc'},newTableStart="100%",tableEnd="-100%";pageTo=parseInt(pageTo);if(pageTo<currentPage){newTableStart="-100%";tableEnd="100%";}
if(sortBy){dataOut["orderBy"]=sortBy;}
if(sortDir){dataOut["orderDir"]=sortDir;}
if(listType){dataOut["listType"]=listType;}
if($searchBox.length){dataOut["search"]=$searchBox.val();}
dataOut[pagingVar]=pageTo;if($("#adminUserCurrentId").length){dataOut['Id']=$("#adminUserCurrentId").val();}
$.ajax({url:tff.baseUrl+url,data:dataOut,beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$("<div>"+html+"</div>"),$newTable=$html.find(".userTable"),$newPaginationWrap=$html.find(".pagination-wrap"),$newPagination=$newPaginationWrap.find(".paging"),animateSpeed=400;var transitionOut=function($elem,callback){if($.support.transition){$elem.transition({"scale":.8},animateSpeed,callback);}else{if($.isFunction(callback)){callback();}}};var transitionIn=function($elem,callback){if($.support.transition){$elem.transition({"scale":[1.005,1]},animateSpeed,callback);}else{if($.isFunction(callback)){callback();}}};$tableWrap.css({"height":$tableWrap.outerHeight()});transitionOut($table,function(){$table.css({"position":"absolute","top":"0","left":"0%","width":"100%"}).animate({"left":tableEnd},animateSpeed);if($.support.transition){$newTable.css("scale",.8);}
$newTable.css({"position":"absolute","top":"0","left":newTableStart,"width":"100%"}).appendTo($tableWrap).animate({"left":"0%"},animateSpeed);$tableWrap.animate({"height":$newTable.outerHeight()},animateSpeed);setTimeout(function(){transitionIn($newTable,function(){$table.remove();$pagination.replaceWith($newPagination);$tableWrap.attr("data-currentpage",pageTo);$newTable.css({"position":"static"});if(sortBy&&sortDir&&sortDir=="ASC"){$newTable.find('[data-sort="'+sortBy+'"]').removeClass("sortUp").addClass("sortDown").addClass("sortCol");}else if(sortBy&&sortDir&&sortDir=="DESC"){$newTable.find('[data-sort="'+sortBy+'"]').removeClass("sortDown").addClass("sortUp").addClass("sortCol");}});},animateSpeed);});},error:function(xhr){}});};tff.generatePassword=function(l,valid){l=(Number(l))?Number(l):8;valid=(valid)?valid:{'special':1,'upper':1,'lower':1,'numbers':1};var p="";var chars="";if(valid['lower']){chars+="abcdefghijklmnopqrstuvwxyz";}
if(valid['upper']){chars+="ABCDEFGHIJKLMNOPQRSTUVWXYZ";}
if(valid['numbers']){chars+="0123456789";}
if(valid['special']){chars+="~!@#$%^&*()_-+=";}
if(!chars.length){return p;}
var charLength=chars.length;for(var i=l;i>0;i--){p+=chars.charAt(Math.floor(Math.random()*charLength));}
return p;};tff.addMessage=function(m){m.type=(m.type)?m.type.toLowerCase():'e';m.timeOut=(m.timeOut)?m.timeOut:null;if(m.type=='s'){tff.nSuccess(m.message,m.timeOut);}else if(m.type=='i'){tff.nInfo(m.message,m.timeOut);}else{tff.nError(m.message,m.timeOut);}};tff.nSuccess=function(m,to){to=15;$.notify({m:m,t:$._NS,to:to});};tff.nInfo=function(m,to){to=15;$.notify({m:m,t:$._NI,to:to});};tff.nError=function(m,to){to=(to)?to:0;$.notify({m:m,t:$._NE,to:to});};tff.fieldError=function(m,f,to){to=(to)?to:0;var f=$(f);$.notify({m:m,t:$._NE,c:'fe_'+f.attr('id'),to:to});if(f.is(':checkbox, :radio')){f.parent().addClass('ketchup-validation-error');}else{f.addClass('ketchup-validation-error');}};tff.confirmAction=function(m){var result=confirm(m);if(result){return true;}else{return false;}};var BASE64_DATA=/^data:.*;base64/i;var base64Path=tff.baseUrl+"/upload_helpers/base64.php";tff.fixBase64=function(imgSrc){var newSrc=imgSrc;if(BASE64_DATA.test(newSrc)){newSrc=base64Path+"?"+newSrc.slice(5);}
return newSrc;};;tff['ui-kit']={start:function(){}};tff['login']={start:function(){$('.datepicker').datepicker();}};tff['home']={start:function(){function setTabLIWidth(){var tabWidth=$('#tabContent').width();$('.quotes li').css('width',(tabWidth-40+'px'));var quotesWidth=$('.quotes li').length*tabWidth;$('.quotes').css('width',quotesWidth);$('#imageRise a.active').show();}
setTabLIWidth();function hideImageRise(){$('#imageRise').stop().animate({top:'-5px',height:'55px'});}
function showImageRise(){$('#imageRise').stop().animate({top:'-40px',height:'100px'});}
function raiseImageRise(){$('#imageRise').stop().animate({top:'-128px',height:'200px'});}
var handleCta=function(){var outerSelector="#featureButtons",wrapSelector=".largeRound-wrap",ctaSelector=".largeRound",ctaInnerSelector=".largeRoundInner",$outerWrap=$(outerSelector),$wrap=$outerWrap.find(wrapSelector),$ctas=$outerWrap.find(ctaSelector),$wrapFirst=$wrap.first().addClass("first"),$wrapLast=$wrap.last().addClass("last"),ctaHeight=$wrapFirst.height(),animSpeed=400,animSpecial=(jQuery.support.transform3d&&$.support.transition);if($.support.transition){$outerWrap.addClass("transition");}
var animations={topOut:function(){$wrapFirst.addClass("out");if(!$.support.transition){$wrapFirst.stop().animate({top:'-50px',opacity:0});}},topIn:function(){$wrapFirst.removeClass("out");if(!$.support.transition){$wrapFirst.stop().animate({top:'0px',opacity:1});}},topGrow:function(){$wrapFirst.addClass("big");if(!$.support.transition){$wrapFirst.find(ctaSelector).stop().animate({'height':'190px','z-index':20});$wrapFirst.find(ctaInnerSelector).stop().animate({'height':'190px','z-index':20});$wrapFirst.find(ctaInnerSelector).find("a").stop().animate({'opacity':1});$wrapFirst.find(".right-arrow").stop().animate({width:'6.5px',height:'10.5px',top:'35px'});}},topShrink:function(){$wrapFirst.removeClass("big");if(!$.support.transition){$wrapFirst.find(ctaSelector).stop().animate({'height':'75px','z-index':10});$wrapFirst.find(ctaInnerSelector).stop().animate({'height':'75px','z-index':10});$wrapFirst.find(ctaInnerSelector).find("a").stop().animate({'opacity':0});$wrapFirst.find(".right-arrow").stop().animate({width:'13px',height:'21px',top:'33px'});}},bottomOut:function(){$wrapLast.addClass("out");if(!$.support.transition){$wrapLast.stop().animate({bottom:'-50px',opacity:0});}},bottomIn:function(){$wrapLast.removeClass("out");if(!$.support.transition){$wrapLast.stop().animate({bottom:'0px',opacity:1});}},bottomGrow:function(){$wrapLast.addClass("big");if(!$.support.transition){$wrapLast.find(ctaSelector).stop().animate({'height':'190px','z-index':20});$wrapLast.find(ctaInnerSelector).stop().animate({'height':'190px','z-index':20});$wrapLast.find(ctaInnerSelector).find("a").stop().animate({'opacity':1});$wrapLast.find(".right-arrow").stop().animate({width:'6.5px',height:'10.5px',top:'35px'});}},bottomShrink:function(){$wrapLast.removeClass("big");if(!$.support.transition){$wrapLast.find(ctaSelector).stop().animate({'height':'75px','z-index':10});$wrapLast.find(ctaInnerSelector).stop().animate({'height':'75px','z-index':10});$wrapLast.find(ctaInnerSelector).find("a").stop().animate({'opacity':0});$wrapLast.find(".right-arrow").stop().animate({width:'13px',height:'21px',top:'33px'});}}};$wrap.hover(function(){var $this=$(this),$other=$wrap.not($this),$thisInner=$this.find(ctaInnerSelector);if($this.is($wrapFirst)){animations.bottomOut();animations.topGrow();}else{animations.topOut();animations.bottomGrow();}},function(){animations.topIn();animations.bottomIn();animations.bottomShrink();animations.topShrink();});}();var handleFancyboxMedia=function(){$('.fancybox-media').fancybox({openEffect:'none',closeEffect:'none',maxWidth:800,maxHeight:600,fitToView:false,width:'70%',height:'70%',helpers:{media:{}}});}();var handleTestimonialArrow=function(){var $innerWrapper=$(".innerWrapper"),$tabsWrapper=$innerWrapper.find(".tabs"),$arrowWrapper=$tabsWrapper.find(".tabs-arrow-wrap"),$arrow=$arrowWrapper.find(".tabs-arrow"),duration=400;if($.support.transition){$("html").addClass("transition");}
if(!$.support.transition){$arrow.css({"opacity":0,"top":"0px","left":"0px"});$innerWrapper.hover(function(){$arrow.stop().animate({"opacity":1},duration);},function(){$arrow.stop().animate({"opacity":0},duration);});}}();$('#imageRise').hover(function(){var contentActive=$('#tabContent .contentActive').attr('id');if(contentActive=='customers'){raiseImageRise();}},function(){var contentActive=$('#tabContent .contentActive').attr('id');if(contentActive=='customers'){showImageRise();}});$('.tabNav a').click(function(e){e.preventDefault();var thisNav=$(this);var tabCon=$('#tabContent');var contentId=thisNav.attr('href');contentId=contentId.substring(1);if(contentId=='vendors'){hideImageRise();}else{showImageRise();}
if(!thisNav.hasClass('active')){$('.tabNav a').removeClass('active');thisNav.addClass('active');tabCon.children().removeClass('contentActive').slideUp();tabCon.find('#'+contentId).addClass('contentActive').delay(300).slideDown();}});$('.quoteLeftNav').on('click',function(){var leftPos=$('.contentActive ul').css('left');var moveTo=$('#tabContent').width();var parentType=$(this).parents('.contentActive').attr('id');if(parseInt(leftPos)!=0){$(this).parent().siblings('.quotes').animate({left:'+='+moveTo});if(parentType=='customers'){$('#imageRise a.active').prev().addClass('active').fadeIn().end().removeClass('active').fadeOut();}}});$('.quoteRightNav').on('click',function(){var leftPos=$('.contentActive ul').css('left');var moveTo=$('#tabContent').width();var liLength=$(this).parent().siblings('.quotes').children('li').length;var totalWidth=(moveTo*(liLength-1));var parentType=$(this).parents('.contentActive').attr('id');if(parseInt(leftPos)!=-(totalWidth)){$(this).parent().siblings('.quotes').animate({left:'-='+moveTo});if(parentType=='customers'){$('#imageRise a.active').next().addClass('active').fadeIn().end().removeClass('active').fadeOut();}}});$('input.datepicker').datepicker({minDate:+1});$('.miniSlider').simpleSlider({startSlide:1,transitionSpeed:1500,transition:'slide',direction:'left',autoSlide:true,navigation:true});var winWidth=$(window).width();var curSlide=1;var hover=false;var slide;var slideLength=$('.slide').length;var mower='left';var duration=1500;var removeHasVisitedCookie=function(){$.cookie("gp-hasvisited",null);};var setHasVisitedCookie=function(){curSlide=2;if(!$.cookie("gp-hasvisited")){curSlide=1;$.cookie("gp-hasvisited",true);}}();$('#nextBtn, #prevBtn').css({opacity:0});$('#slideContainer').hover(function(){$('#nextBtn').stop().animate({right:20,opacity:0.2},300);$('#prevBtn').stop().animate({left:20,opacity:0.2},300);},function(){$('#nextBtn').stop().animate({right:10,opacity:0},300);$('#prevBtn').stop().animate({left:10,opacity:0},300);});$('#nextBtn, #prevBtn').on('mouseenter',function(){$(this).stop().animate({opacity:1},300);});$('#nextBtn, #prevBtn').on('mouseleave',function(){$(this).stop().animate({opacity:.2},300);});$('#nextBtn, #prevBtn').on('click',function(){clearInterval(slide);var b=$(this).attr('id');if(b=='prevBtn'){slideTo(curSlide-1,duration);}else{slideTo(curSlide+1,duration);}});$('.slidenav').on('click',function(){var p=$(this).parent().attr('id');p=parseInt(p.substr(9));dur=(Math.abs(curSlide-p)>1)?2000:duration;slideTo(p,dur);});$('#sliderContainer').on('mouseenter',function(){$('#slidePos').fadeIn();hover=true;});$('#sliderContainer').on('mouseleave',function(){$('#slidePos').stop().fadeOut();hover=false;clearInterval(slide);autoSlide();});function animSlideContent(r){switch(r){case 1:animBee3();growFlower();break;case 2:growFlower();moveMower();break;case 3:animBee1();animBee2();growFlower();break;}
changeSlideNav(curSlide);}
function slideTo(r,dur){var distance;$('#ui-datepicker-div').hide();if(r<1||r>slideLength){r=1;}
if(r==1){distance=0;}else{if(r==slideLength){distance=-(winWidth*(slideLength-1));}else{distance=(winWidth*(r-slideLength));}}
$('#foreGrass').animate({left:(distance*1.5)},dur);$('#rearGrass').animate({left:(distance/4)},dur);$('#sliderUl').animate({left:distance},dur);curSlide=r;animSlideContent(r);}
function changeSlideNav(curSlide){$('.slidenav.hover').removeClass('hover');$('#slidePos_'+curSlide).children('.slidenav').addClass('hover');}
function setSlidePosition(){curWinWidth=$(window).width();var sUL=$('.slide').length;$('.slide').each(function(){$(this).css('width',curWinWidth+'px');});$('#sliderWrapper, #sliderUl').css('width',(curWinWidth*sUL*1.5)+'px');if(curSlide>1){if(curWinWidth>winWidth){pm='-='+((curWinWidth-winWidth))+'px';}else{pm='+='+((winWidth-curWinWidth))+'px';}
$('#sliderUl').css('left',pm);}
winWidth=curWinWidth;}
function animBee2(){var $bee=$('#bee2'),beeLeft=0,beeX=0,beeY=0,beeSpeedX=1,beeSpeedY=-1,framerate=60,curFrame=0;$bee.css({top:'275px',left:'650px',width:'15px',height:'11px',x:0,y:0,rotate:'.001deg','z-index':-1});var go=function(){curFrame++;if(curSlide!==3){return;}
beeX=Math.sin(curFrame*.05)*(100*beeSpeedX);beeY=Math.cos(curFrame*.3)*(3*beeSpeedY);beeX+=beeSpeedX;$bee.transition({x:beeX,y:beeY},framerate);requestTimeout(go,framerate);};if(curSlide===3){go();}}
function animBee1(){var bee1=$('#bee1');bee1.css({top:'220px',left:'500px',width:'15px',height:'11px',opacity:.5,rotate:'45deg'}).animate({top:'330px',left:'550px',width:'25px',height:'24px',opacity:1},3000,'linear',function(){bee1.animate({top:'350px',left:'600px',rotate:'10deg'},1000);});}
function animBee3(){var bee1=$('#bee3');bee1.css({top:'220px',left:'550px',width:'15px',height:'11px',opacity:.5,rotate:'45deg'}).animate({top:'330px',left:'650px',width:'25px',height:'24px',opacity:1},3000,'linear',function(){bee1.animate({top:'357px',left:'695px',rotate:'10deg'},1000);});}
function growFlower(){var dande=$('.dandelion'),bottom="40px";dande.css('bottom','-10px');if(curSlide==2){bottom="75px";}
if(curSlide==2&&$.browser.msie){bottom="35px";}
setTimeout(function(){dande.animate({bottom:bottom,opacity:1},2000);},1000);}
function moveMower(){var left='100px';$('#slide3mower').css('left','350px').animate({'left':left},5500);}
function autoSlide(){if(!!$.cookie("gp-hasvisited")){return false;}
slide=setInterval(function(){if(!hover){slideTo(curSlide+1,duration);}},11000);}
var animateClouds=function(){var $cloud3=$("#cloud3"),$cloud1=$("#cloud1").css({rotate:'.001deg'}),cloud3Left=0,cloud1Left=0,cloud1Speed=.15,cloud3Speed=.3,$window=$(window),windowWidth=$window.width(),framerate=60;$cloud3.css({left:$(window).width()-$cloud3.width()-100,rotate:'.001deg'});$window.bind("resize.animateClouds",function(){windowWidth=$window.width();});var go=function(){cloud3Left+=cloud3Speed;cloud1Left+=cloud1Speed;$cloud3.transition({x:cloud3Left},framerate);$cloud1.transition({x:cloud1Left},framerate);if(cloud3Speed<0&&cloud3Left<(-1*windowWidth)){cloud3Speed*=-1;}else if(cloud3Speed>=0&&cloud3Left>windowWidth){cloud3Speed*=-1;}
if(cloud1Speed<0&&cloud1Left<-100){cloud1Speed*=-1;}else if(cloud1Speed>=0&&cloud1Left>windowWidth){cloud1Speed*=-1;}
requestTimeout(go,framerate);};go();}();var initHomePhones=function(){var $features=$("#appFeatures"),$wrap=$(".feature-phone-wrap"),$phones=$wrap.find("img")
$first=$phones.first(),$last=$phones.last(),animateDuration=300,animateLastIncreasePercentage=2;if($.support.transition){$('html').addClass("transition");}
$features.hover(function(){$this=$(this);if(!$.support.transition){$first.stop().animate({top:"145px",},animateDuration);$last.stop().animate({top:"135px",},animateDuration*animateLastIncreasePercentage);}},function(){$this=$(this);if(!$.support.transition){$first.stop().animate({top:"175px",},animateDuration);$last.stop().animate({top:"180px",},animateDuration*animateLastIncreasePercentage);}});}();setSlidePosition();$(window).resize(function(){setSlidePosition();});slideTo(curSlide,duration);autoSlide();}};tff['features']={start:function(){if($.support.transition){$('body').addClass("transition");}
var handleFancyboxMedia=function(){$('.fancybox-media').fancybox({openEffect:'none',closeEffect:'none',maxWidth:800,maxHeight:600,fitToView:false,width:'70%',height:'70%',helpers:{media:{}}});}();}};tff['comp-review']={start:function(){$('#company_review').on('click',':button, :submit',function(){var a=$(this).attr('id').substr(3);$('#review_action').val(a);});}};tff['comp-edit']={start:function(){$('input.date, input.datepicker').datepicker();var p=$('#upd_ServicePostal');var lat=$('#upd_ServiceLat');var lng=$('#upd_ServiceLng');$('#updateServiceArea_form').on('change','#upd_ServicePostal',function(){tff.debug("change");if(p.val().length){tff.debug("p.val");tff.geocodeAddress(p.val(),function(geo){if(geo&&geo.length==2){lat.val(geo[0]);lng.val(geo[1]);}});}else if(lat.val().toString().length&&lng.val.toString().length){tff.debug("get zip from lat lng");tff["comp-edit"].methods.getZipFromLatlng(lat.val(),lng.val(),function(zip){tff.debug("success");tff.debug(zip);p.val(zip);});}}).trigger("change");p.trigger("change");$("#accordion").accordion({autoHeight:false,clearStyle:true});var initForm=function(){var $form=$("#compEdit_form"),$loader=$form.find(".loader"),$submitButton=$form.find('input[type="submit"]'),$imagesWrap=$form.find("#companyImages");$form.ajaxForm({beforeSubmit:function(){$loader.fadeIn(400);$submitButton.addClass("disabled");},success:function(html){$loader.hide();$submitButton.removeClass("disabled");tff.nSuccess("Your company information has been updated");},error:function(xhr){$loader.hide();tff.nError("There was a problem submitting the form. Please contact the webmaster for assistance.");}});$imagesWrap.on("click.remove-image",".simpleFilePreview_remove",function(e){var self=this,$this=$(self),$target=$(e.target),$previewWrap=$this.closest(".simpleFilePreview"),$submitButton=$form.find('input[type="submit"]'),id=$previewWrap.attr("data-sfprid");if(tff.confirmAction("Are you sure you want to delte this image?")){if(id){$.ajax({url:$form.attr("action"),type:"POST",data:{"action":"update","removeFiles":new Array(id),"ajax":true},beforeSend:function(){$submitButton.addClass("disabled");$loader.fadeIn(400);},success:function(data){$remove=$previewWrap.find('[name="removeFiles[]"]');$loader.fadeOut(400);if($remove.length){$remove.remove();$previewWrap.removeAttr("data-sfprid");$submitButton.removeClass("disabled");tff.nSuccess("The image was deleted");}}});}}});};initForm();var getCompanyEditForm=function(url,callback){var $div=$("<div></div>");$div.load(url+" #compEdit_form",function(html){if($.isFunction(callback)){callback($div.html());}});};},methods:{"getZipFromLatlng":function(lat,lng,callback){var latlng=new google.maps.LatLng(lat,lng),geocoder=new google.maps.Geocoder(),zip="";geocoder.geocode({'latLng':latlng},function(results,status){if(status==google.maps.GeocoderStatus.OK){var result,components,types,isPostalCode;if(results.length){result=results[0];components=result["address_components"];$.each(components,function(i){types=this.types;isPostalCode=false;$.each(types,function(j){if(this=="postal_code"){isPostalCode=true;}});if(isPostalCode){zip=this.long_name;return;}});if($.isFunction(callback)){callback(zip);}}else{}}else{}});}}};tff['comp-dash']={start:function(){if($.support.transition){$("html").addClass("transition");}
var $window=$(window);var adminUserCurrentId=0;if($("#adminUserCurrentId").length){adminUserCurrentId=$("#adminUserCurrentId").val();}
var tabs={"dashboard":{"init":function(){if(!tabs.dashboard.elements){tabs.dashboard.elements={};}
tabs.dashboard.elements.$tab=$("#tabs #dashboard");tabs.dashboard.methods.initLatestAccountActivity();},"methods":{initLatestAccountActivity:function(callback){var $wrapper=$(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),liveIntervalDelay=(1000*60*5);$.ajax({url:tff.baseUrl+'/api/notification/type-company',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},dataType:'json',success:function(d){var types=d["Types"],i=0,thisId=0,length=types.length,$ul=$("<ul class='filter-list'></ul>"),thisType,$li,thisHtml,itemSpacer="&nbsp;/&nbsp;";if($(".filter-list").not($ul).length){$(".filter-list").remove();}
$li=$("<li></li>").data("data-type","all").data("data-typeId",-1).attr("data-type","all").attr("data-typeId",-1).html('<a href="#dashboard/activity/-1">All</a>').appendTo($ul);if(length){for(i=0;i<length;i++){thisType=types[i];thisId=thisType.id;thisHtml='<a href="#dashboard/activity/'+thisId+'">'+thisType.title+'</a>';thisHtml=itemSpacer+thisHtml;$li=$("<li></li>").data("data-type",thisType.title).data("data-typeId",thisId).attr("data-type",thisType.title).attr("data-typeId",thisId).html(thisHtml).appendTo($ul);}
$filterList=$ul.appendTo(".filter-wrap");}
tabs.dashboard.methods.setCountNotifications();setInterval(function(){tabs.dashboard.methods.setCountNotifications();},liveIntervalDelay);var setNewNotifications=function(){var typeId=$listWrap.attr("data-typeId"),$firstLi=$listWrap.children("ul").children("li").first(),latestId=$firstLi.attr("data-id");$.ajax({url:tff.baseUrl+'/api/notification/activity-company',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':typeId,'firstId':latestId},beforeSend:function(){},success:function(data){var $ul=$(data),$li=$ul.find("li"),firstLiTop=75*$li.length;if(!$li.length){return false;}
$firstLi.animate({"margin-top":firstLiTop+"px"},400,function(){$li.css({"display":"none"}).insertBefore($firstLi).fadeIn(400);$firstLi.css("margin-top",0);resizeTabContent();});},error:function(xhr){}});};setInterval(function(){setNewNotifications();},liveIntervalDelay);if($.isFunction(callback)){callback();}},error:function(xhr){tff.nError("There was a problem. Please contact the webmaster for assistance.");}});var scrollTimeout,scrollDelay=100;var checkScrollPos=function(){var curY=window.scrollY,windowHeight=$(window).height(),top=$listWrap.offset().top,height=$listWrap.height(),bottom=top+height,typeId=$listWrap.attr("data-typeId"),$lastItem=$listWrap.find(".notifyItem").last(),searchTerm=$wrapper.find(".notification-search").val();if(((windowHeight+curY)>bottom)&&!$listWrap.find(".no-more-notifications").length){$.ajax({url:tff.baseUrl+'/api/notification/activity-company',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':typeId,'lastId':$lastItem.attr("data-id"),'search':searchTerm,Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.stop().fadeIn(400);},success:function(html){$loader.stop().fadeOut(400);var $ul=$(html),$items=$ul.children("li");if($items.length){$items.insertAfter($lastItem);}else{if(!$listWrap.find(".no-more-notifications").length){$ul.appendTo($listWrap);}}
resizeTabContent();},error:function(xhr){tff.nError("There was a problem getting notifications. Please contact the webmaster for assistance.");}});}};$window.scroll(function(){clearTimeout(scrollTimeout);scrollTimeout=setTimeout(function(){checkScrollPos();},scrollDelay);});$wrapper.find(".refresh").bind("click",function(){$window.trigger("hashchange");});$wrapper.find(".refresh").bind("click",function(){$window.trigger("hashchange");});var keyupTimeout=0,keyupTimeoutDelay=600;$wrapper.find(".notification-search").bind("keyup",function(e){clearTimeout(keyupTimeout);var $this=$(this);if($this.val().length){$wrapper.find(".markasread").addClass("disabled");}else{$wrapper.find(".markasread").removeClass("disabled");}
keyupTimeout=setTimeout(function(){$wrapper.find(".refresh").trigger("click");},keyupTimeoutDelay);});$wrapper.find(".markasread").bind("click",function(e){var self=this,$this=$(self),$target=$(e.target);if($this.is(".disabled")){return false;}
e.preventDefault();tabs.dashboard.methods.markNotificationsAsRead();});},setCountNotifications:function(){var $wrapper=$(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$existingBoxes=$(".count-box");$filterList.find("li").each(function(){var $this=$(this),typeId=$this.attr("data-typeId"),$existingBoxes=$(".count-box"),curData;if(typeId==-1||typeId=="activity"){typeId=-1;$this=$('.tabNav a[href="#dashboard"]').closest("li").css("position","relative");}
TweenMax.to($existingBoxes,0.3,{"opacity":"0","margin-top":"-10px","onComplete":function(){$existingBoxes.remove();}});$.ajax({url:tff.baseUrl+'/api/notification/activity_count-company',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':typeId,Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){},success:function(data){var $countBox=$this.find(".count-box");if(!$countBox.length){if(parseInt(data)<=0){return false;}
$countBox=$('<div class="count-box"></div>').css({"opacity":"0","margin-top":"-10px"}).html(data).appendTo($this).animate({"opacity":"1","margin-top":"0px"},300);}else{curData=$this.find(".count-box").html();if(parseInt(data)<=0){$countBox.animate({"margin-top":"-10px","opacity":0},300,function(){$countBox.remove();});}else if(curData!=data){$countBox.animate({"margin-top":"-10px"},100,function(){$countBox.animate({"margin-top":"0px"},100);});}}
$countBox.html(data);},error:function(xhr){}});});},onHashChanged:function(hashAr){tabs.dashboard.methods.getLatestAccountActivity(hashAr);},showSearch:function(callback){var $tab=tabs.dashboard.elements.$tab,$toShow=$tab.find(".notification-actions .action"),$listWrap=$tab.find(".list-wrap");TweenMax.to($listWrap,.5,{"y":0});TweenMax.to($toShow.show(),.5,{"opacity":1,"y":0,"onComplete":function(){if($.isFunction(callback)){callback();}}});},hideSearch:function(callback){var $tab=tabs.dashboard.elements.$tab,$toHide=$tab.find(".notification-actions .action"),$searchField=$tab.find(".notification-search"),$listWrap=$tab.find(".list-wrap"),toHideTallest=$toHide.first().height()/2;$searchField.val("");TweenMax.to($listWrap,.5,{"y":-1*toHideTallest});TweenMax.to($toHide,.5,{"opacity":0,"y":-1*toHideTallest,"onComplete":function(){$toHide.hide();if($.isFunction(callback)){callback();}}});},markNotificationsAsRead:function(){var $tab=tabs.dashboard.elements.$tab,$wrapper=$tab.find(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),searchTerm=$wrapper.find(".notification-search").val(),hash=window.location.hash.replace("#",""),hashAr=hash.split("/"),hashLen=hashAr.length,category=(hashLen)?hashAr.shift():"activity",val=(hashAr.length)?hashAr.shift():"-1",current=$filterList.data('currentLocation');$.ajax({url:tff.baseUrl+'/api/notification/activity-company',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':val,'search':searchTerm,'action':"readall",'recipientType':"Company",Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.stop().fadeIn(400);},success:function(ret){if(!!ret){if(ret.Success&&ret.Success.length){tff.nSuccess(ret.Success);}
if(ret.Info&&ret.Info.length){tff.nInfo(ret.Info);}
if(ret.Error&&ret.Error.length){tff.nError(ret.Error);}}
$wrapper.find(".refresh").trigger("click");},error:function(xhr){}});},getLatestAccountActivity:function(hashAr,ignoreHash){var $tab=tabs.dashboard.elements.$tab,$wrapper=$tab.find(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),searchTerm=$wrapper.find(".notification-search").val();var hashLen=hashAr.length,category=(hashLen)?hashAr.shift():"activity",val=(hashAr.length)?hashAr.shift():"-1",current=$filterList.data('currentLocation');if(parseInt(val)==-1){tabs.dashboard.methods.showSearch();}else{tabs.dashboard.methods.hideSearch();searchTerm="";}
$.ajax({url:tff.baseUrl+'/api/notification/activity-company',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':val,"search":searchTerm,Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$listWrap.fadeOut(400);$filterList.find("li").removeClass("active");$filterList.find('li[data-typeId="'+val+'"]').addClass('active');$listWrap.attr("data-typeId",val);$loader.stop().fadeIn(400);},success:function(html){$loader.stop().fadeOut(400);$listWrap.html(html);$listWrap.fadeIn(400);resizeTabContent();tabs.dashboard.methods.setCountNotifications();},error:function(xhr){tff.nError("There was a problem getting notifications. Please contact the webmaster for assistance.");}});}}},"appointments":{init:function(){if(!tabs.appointments.elements){tabs.appointments.elements={};tabs.appointments.elements.$tab=$("#tabs #appointments");tabs.appointments.elements.$tab.on("click.appointments-paging",".paging a",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),href=$target.attr("href"),pageTo=1,hrefAr=href.split("?"),$section=$target.closest(".appointments-section"),$table=$section.find(".userTable"),listType=$table.attr("data-listtype"),pagingVar=tabs.appointments.methods.getPagingVar(listType);if(hrefAr.length>1){hrefAr=hrefAr[1].split("&");for(var i=0;i<hrefAr.length;i++){hrefAr[i]=hrefAr[i].split("=");}
for(var i=0;i<hrefAr.length;i++){if(hrefAr[i][0]==pagingVar){pageTo=hrefAr[i][1];continue;}}}
tff.pageTable($section,$table.closest(".table-wrap"),$table,'/api/appointment/all-ajax',pagingVar,pageTo);});tabs.appointments.elements.$tab.on("click.appointments-sorting","[data-sort]",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),sortBy=$target.attr("data-sort"),pageTo=1,$section=$target.closest(".appointments-section"),$table=$section.find(".userTable"),$tableWrap=$table.closest(".table-wrap"),listType=$table.attr("data-listtype"),pagingVar=tabs.appointments.methods.getPagingVar(listType);if($tableWrap.attr("sortBy")!=sortBy){$tableWrap.removeAttr("sortDir");}
if(sortBy){$tableWrap.attr("sortBy",sortBy);if(!$tableWrap.attr("sortDir")){$tableWrap.attr("sortDir","ASC");}else if($tableWrap.attr("sortDir")=="ASC"){$tableWrap.attr("sortDir","DESC");}else{$tableWrap.removeAttr("sortDir");$tableWrap.removeAttr("sortBy");}}
tff.pageTable($section,$tableWrap,$table,'/api/appointment/all-ajax',pagingVar,pageTo);});}else{tabs.appointments.methods.initAppointmentsToday();tabs.appointments.methods.initAppointmentsNext5();tabs.appointments.methods.initAppointmentsOther();}},methods:{initAppointmentsToday:function(){var $tab=tabs.appointments.elements.$tab,$appointmentsWrap=$tab.find(".appointments-today-wrap"),$loader=$appointmentsWrap.find(".loader").hide(),$wrapper=$appointmentsWrap.find(".appointments-today");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/appointment/all-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',listType:'today',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initAppointmentsNext5:function(){var $tab=tabs.appointments.elements.$tab,$appointmentsWrap=$tab.find(".appointments-next5-wrap"),$loader=$appointmentsWrap.find(".loader").hide(),$wrapper=$appointmentsWrap.find(".appointments-next5");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/appointment/all-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',listType:'nextfive',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initAppointmentsOther:function(){var $tab=tabs.appointments.elements.$tab,$appointmentsWrap=$tab.find(".appointments-other-wrap"),$loader=$appointmentsWrap.find(".loader").hide(),$wrapper=$appointmentsWrap.find(".appointments-other");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/appointment/all-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',listType:'allappts',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},hideSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.removeClass("active");$tableWrap.animate({"height":"0"},400);$paginationWrap.fadeOut(400);},showSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.addClass("active");$tableWrap.animate({"height":$tableWrap.find("table").first().outerHeight()},400);$paginationWrap.fadeIn(400);},onHashChanged:function(hashAr){tabs.appointments.init();},getPagingVar:function(listType){var pagingVar="all_page";switch(listType){case"today":pagingVar="today_page";break;case"nextfive":pagingVar="next_page";break;case"allappts":default:pagingVar="all_page";break;}
return pagingVar;}}},"auctions":{init:function(){if(!tabs.auctions.elements){tabs.auctions.elements={};tabs.auctions.elements.$tab=$("#tabs #auctions");tabs.auctions.elements.$tab.on("click.auctions-paging",".paging a",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),href=$target.attr("href"),pageTo=1,hrefAr=href.split("?"),$section=$target.closest(".auctions-section"),$table=$section.find(".userTable"),listType=$table.attr("data-listtype"),pagingVar=tabs.auctions.methods.getPagingVar(listType);if(hrefAr.length>1){hrefAr=hrefAr[1].split("&");for(var i=0;i<hrefAr.length;i++){hrefAr[i]=hrefAr[i].split("=");}
for(var i=0;i<hrefAr.length;i++){if(hrefAr[i][0]==pagingVar){pageTo=hrefAr[i][1];continue;}}}
tff.pageTable($section,$table.closest(".table-wrap"),$table,'/api/auction/all-ajax',pagingVar,pageTo);});tabs.auctions.elements.$tab.on("click.auctions-sorting","[data-sort]",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),sortBy=$target.attr("data-sort"),pageTo=1,$section=$target.closest(".auctions-section"),$table=$section.find(".userTable"),$tableWrap=$table.closest(".table-wrap"),listType=$table.attr("data-listtype"),pagingVar=tabs.auctions.methods.getPagingVar(listType);if($tableWrap.attr("sortBy")!=sortBy){$tableWrap.removeAttr("sortDir");}
if(sortBy){$tableWrap.attr("sortBy",sortBy);if(!$tableWrap.attr("sortDir")){$tableWrap.attr("sortDir","ASC");}else if($tableWrap.attr("sortDir")=="ASC"){$tableWrap.attr("sortDir","DESC");}else{$tableWrap.removeAttr("sortDir");$tableWrap.removeAttr("sortBy");}}
tff.pageTable($section,$tableWrap,$table,'/api/auction/all-ajax',pagingVar,pageTo);});}else{tabs.auctions.methods.initAuctions();}},methods:{initAuctions:function(){var $tab=tabs.auctions.elements.$tab,$auctionsWrap=$tab.find(".auctions-wrap"),$loader=$auctionsWrap.find(".loader").hide(),$wrapper=$auctionsWrap.find(".auctions-section");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/auction/all-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper);$html.fadeIn(400);resizeTabContent();$tab.find('.watermark').each(function(){var a=$(this).attr('alt');if(a&&a.length){$(this).watermark(a).blur();}});var keyupTimeout=0,keyupTimeoutDuration=600;$(".auction-search").unbind("keyup").bind("keyup",function(e){var self=this,$this=$(self);clearTimeout(keyupTimeout);keyupTimeout=setTimeout(function(){tabs.auctions.methods.searchAuctions($this);},keyupTimeoutDuration);});},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},searchAuctions:function($target){tff.debug("searching");var self=this,$this=$(self),pageTo=1,$section=$target.closest(".auctions-section"),$table=$section.find(".userTable"),$tableWrap=$table.closest(".table-wrap"),listType=$table.attr("data-listtype"),pagingVar=tabs.auctions.methods.getPagingVar(listType);tff.pageTable($section,$tableWrap,$table,'/api/auction/all-ajax',pagingVar,0);},hideSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.removeClass("active");$tableWrap.animate({"height":"0"},400);$paginationWrap.fadeOut(400);},showSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.addClass("active");$tableWrap.animate({"height":$tableWrap.find("table").first().outerHeight()},400);$paginationWrap.fadeIn(400);},onHashChanged:function(hashAr){tabs.auctions.init();},getPagingVar:function(listType){var pagingVar="page";return pagingVar;}}},"profile":{init:function(){if(!tabs.profile.elements){tabs.profile.elements={};tabs.profile.elements.$tab=$("#tabs #profile");}else{tabs.profile.methods.getProfile();}},methods:{onHashChanged:function(hashAr){tabs.profile.init();},getProfile:function(){var $tab=tabs.profile.elements.$tab,$profileWrap=$tab.find(".profile-wrap"),$loader=$profileWrap.find(".loader").hide(),$wrapper=$profileWrap.find(".profile-section");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/user/edit-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();tabs.profile.methods.initProfile();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initProfile:function(){var $tab=tabs.profile.elements.$tab;$tab.find(':text, :password').addClass('text');$tab.find('.watermark').each(function(){var a=$(this).attr('alt');if(a&&a.length){$(this).watermark(a).blur();}});$tab.find('.startHere:first').focus();$tab.find('input.url').blur(function(){if($(this).val().length&&!/^http/.test($(this).val())){$(this).val('http://'+$(this).val());}});$tab.find('form.validate').ketchup(tff.ketchupOptions);$tab.find('body').on('fieldValidationFailed.ketchup','div.group.hasNote input, div.group select, div.group.hasNote textarea',function(){$(this).parents('.group').append($(this).siblings('.ketchup-error-container'));});$tab.find('.ketchup-error-container').hover(function(){$(this).find('.ketchupMessage').stop().fadeTo(500,1);},function(){$(this).find('.ketchupMessage').stop().fadeTo(500,0);});$tab.find('a[title], .toolTipBase').simpleTip();$tab.find(':button, :submit').not('.magnifier').not(".no-button").addClass('button');tabs.profile.methods.submitProfileForm($tab.find("form"));},submitProfileForm:function($form){var $tab=tabs.profile.elements.$tab,dataOut=$form.serialize(),$loader=$form.find(".spinner");$form.ajaxForm({beforeSubmit:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();tff.nSuccess("Your lawn has been updated");},error:function(xhr){$loader.hide();tff.nError("There was a problem submitting the form. Please contact the webmaster for assistance.");}});}}},"company":{init:function(){if(!tabs.company.elements){tabs.company.elements={};tabs.company.elements.$tab=$("#tabs #company");}else{tabs.company.methods.getProfile();tabs.company.methods.getReviews();}},methods:{onHashChanged:function(hashAr){tabs.company.init();},getProfile:function(){var $tab=tabs.company.elements.$tab,$companyWrap=$tab.find(".company-wrap"),$wrapper=$companyWrap.find(".company-section"),$loader=$wrapper.find(".loader").hide(),$innerWrapper=$wrapper.find(".content-wrap");$innerWrapper.html("");$.ajax({url:tff.baseUrl+'/api/company/view-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($innerWrapper).fadeIn(400);resizeTabContent();tabs.company.methods.initProfile();},error:function(xhr){$loader.hide();$innerWrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initProfile:function(){var $tab=tabs.company.elements.$tab,$companyWrap=$tab.find(".company-wrap"),$wrapper=$companyWrap.find(".company-section");tabs.company.methods.initStars($wrapper);},getReviews:function(){var $tab=tabs.company.elements.$tab,$companyWrap=$tab.find(".company-wrap"),$wrapper=$companyWrap.find(".reviews-section"),$loader=$wrapper.find(".loader").hide(),$innerWrapper=$wrapper.find(".content-wrap");$innerWrapper.html("");$.ajax({url:tff.baseUrl+'/api/company/reviews-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($innerWrapper).fadeIn(400);resizeTabContent();tabs.company.methods.initReviews();},error:function(xhr){$loader.hide();$innerWrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initReviews:function(){var $tab=tabs.company.elements.$tab,$companyWrap=$tab.find(".company-wrap"),$wrapper=$companyWrap.find(".reviews-section");tabs.company.methods.initStars($wrapper);},initStars:function($wrapper){$wrapper.find('.star-rating').each(function(){var star=$(this).attr('id').split('result')[1];var m=($(this).hasClass('form'))?36:18;$(this).css("background-position","0 -"+(star*m)+"px");});}}},"payments":{init:function(){if(!tabs.payments.elements){tabs.payments.elements={};tabs.payments.elements.$tab=$("#tabs #payments");tabs.payments.elements.$tab.on("click.payments-paging",".paging a",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),href=$target.attr("href"),pageTo=1,hrefAr=href.split("?"),$section=$target.closest(".payments-section"),$table=$section.find(".userTable"),listType=$table.attr("data-listtype"),pagingVar=tabs.payments.methods.getPagingVar(listType);if(hrefAr.length>1){hrefAr=hrefAr[1].split("&");for(var i=0;i<hrefAr.length;i++){hrefAr[i]=hrefAr[i].split("=");}
for(var i=0;i<hrefAr.length;i++){if(hrefAr[i][0]==pagingVar){pageTo=hrefAr[i][1];continue;}}}
tff.pageTable($section,$table.closest(".table-wrap"),$table,'/api/payment/all-ajax',pagingVar,pageTo);});tabs.payments.elements.$tab.on("click.payments-sorting","[data-sort]",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),sortBy=$target.attr("data-sort"),pageTo=1,$section=$target.closest(".payments-section"),$table=$section.find(".userTable"),$tableWrap=$table.closest(".table-wrap"),listType=$table.attr("data-listtype"),pagingVar=tabs.payments.methods.getPagingVar(listType);if($tableWrap.attr("sortBy")!=sortBy){$tableWrap.removeAttr("sortDir");}
if(sortBy){$tableWrap.attr("sortBy",sortBy);if(!$tableWrap.attr("sortDir")){$tableWrap.attr("sortDir","ASC");}else if($tableWrap.attr("sortDir")=="ASC"){$tableWrap.attr("sortDir","DESC");}else{$tableWrap.removeAttr("sortDir");$tableWrap.removeAttr("sortBy");}}
tff.pageTable($section,$tableWrap,$table,'/api/payment/all-ajax',pagingVar,pageTo);});}else{tabs.payments.methods.initPayments();}},methods:{initPayments:function(){var $tab=tabs.payments.elements.$tab,$paymentsWrap=$tab.find(".payments-wrap"),$loader=$paymentsWrap.find(".loader").hide(),$wrapper=$paymentsWrap.find(".payments-section");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/payment/all-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},onHashChanged:function(hashAr){tabs.payments.init();},getPagingVar:function(listType){var pagingVar="payment_page";return pagingVar;}}}};function resizeTabContent(){$('#tabContent').stop().css("overflow","visible").animate({'height':$('#tabContent .contentActive').height()});}
var transitionTab=function(tab){var $tabsWrapper=$("#tabs"),$navWrap=$tabsWrapper.find(".tabNav"),$thisNavLink=$navWrap.find('[href="#'+tab+'"]'),$thisTab=$("#"+tab),$activeContent=$tabsWrapper.find(".contentActive");if(!$thisNavLink.hasClass('active')){$navWrap.find("a").removeClass('active');$thisNavLink.addClass('active');$activeContent.fadeOut(400).removeClass("contentActive");$thisTab.fadeIn(400).addClass("contentActive");resizeTabContent();}};var hashChanged=function(){var hash=window.location.hash.replace("#",""),hashAr=hash.split("/"),hashArLength=hashAr.length,thisTab="dashboard",$thisTab,$thisNav;if(tabs[hashAr[0]]){thisTab=hashAr.shift();}
transitionTab(thisTab);tabs[thisTab].methods.onHashChanged(hashAr);};$window.on('hashchange.comp-dash',hashChanged).on('load',function(){$window.trigger('hashchange.comp-dash');});var $tabs=$("#tabs");$tabs.find(".content").hide();$tabs.find(".tabNav a").each(function(){var $this=$(this),tab=$this.attr("href").replace("#","");if(tabs[tab]){if($.isFunction(tabs[tab].init)){tabs[tab].init();}}});var handleAnimations=function(){var animations={"clouds":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.clouds.elements.$wrap=$("#clouds"),$img=animations.clouds.elements.$img=$wrap.find("div");animations.clouds.methods.start();},"start":function(callback){var $img=animations.clouds.elements.$img,$cloud1=$img.first(),$otherClouds=$cloud1.nextAll("div").hide();cloud3Left=0,cloud1Left=0,cloud1Width=300,cloud1Speed=.5,cloud3Speed=.3,opacitySpeed=.02,opacity=0,$window=$(window),windowWidth=$window.width(),framerate=60;$cloud1.addClass("cloud1").css({opacity:opacity,left:-1*cloud1Width,rotate:'.001deg'});$window.bind("resize.animateClouds",function(){windowWidth=$window.width();});var go=function(){cloud1Left+=cloud1Speed;if(opacity<.6){opacity+=opacitySpeed;}else{opacity=.6;}
$cloud1.transition({x:cloud1Left,opacity:opacity},framerate);if(cloud1Speed<0&&cloud1Left<(-1*cloud1Width)){cloud1Speed*=-1;}else if(cloud1Speed>=0&&cloud1Left>(windowWidth+cloud1Width)){cloud1Speed*=-1;}
requestTimeout(go,framerate);};go();},"stop":function(){}}},"infoTop":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.infoTop.elements.$wrap=$(".info-wrap.info-wrap-top");$wrap.css({"opacity":0,"margin-top":"-100px"});},"start":function(callback){var $wrap=animations.infoTop.elements.$wrap,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};TweenMax.to($wrap,.3,{"opacity":1,"marginTop":"45px",onComplete:function(){onCompleteCallback();TweenMax.to($wrap,.3,{"marginTop":"40px"});}});},"stop":function(){}}},"infoBottom":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.infoBottom.elements.$wrap=$(".info-wrap.info-wrap-bottom");$wrap.css("opacity",0);},"start":function(callback){var $wrap=animations.infoBottom.elements.$wrap,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};$wrap.css("opacity",1);TweenMax.to($wrap,.5,{"rotationX":"30deg",onComplete:function(){TweenMax.to($wrap,.3,{"rotationX":"0deg",onComplete:onCompleteCallback});}});},"stop":function(){}}},"rating":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.rating.elements.$wrap=$(".rating-wrap");$wrap.css({"opacity":0,"marginTop":"-100px"});},"start":function(callback){var $wrap=animations.rating.elements.$wrap,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};TweenMax.to($wrap,.5,{"opacity":1,"marginTop":"40px",onComplete:onCompleteCallback});},"stop":function(){}}},"ratingStars":{"options":{starPosInc:18,starMinPos:-180,starRevealDelay:50},"elements":{},"methods":{"init":function(){var $wrap=animations.ratingStars.elements.$wrap=$(".star-rating");starMinPos=$wrap.css("background-position");starMinPos=parseInt(starMinPos.split(" ")[1].replace("px",""));animations.ratingStars.options.starMinPos=starMinPos;$wrap.css({"background-position":"0px 0px"});},"start":function(callback){var $wrap=animations.ratingStars.elements.$wrap,options=animations.ratingStars.options,onCompleteCallback=function(){if($.isFunction(callback)){callback();}},currentStarPos=0,initStars=function(){setTimeout(function(){currentStarPos-=options.starPosInc;if(currentStarPos>=options.starMinPos){$wrap.css({"background-position":"0px "+currentStarPos+"px"});initStars();}},options.starRevealDelay);};initStars();},"stop":function(){}}}};for(var k in animations){var obj=animations[k],methods=obj["methods"];if(obj){if(methods&&methods["init"]){if($.isFunction(methods["init"])){obj["methods"]["init"]();}}}}
animations.infoTop.methods.start(function(){animations.infoBottom.methods.start(function(){animations.rating.methods.start(function(){animations.ratingStars.methods.start();});});});};handleAnimations();}};tff['comp-view']={start:function(){if($.support.transition){$("html").addClass("transition");}
var $window=$(window);var company={init:function(){if(!company.elements){company.elements={};company.elements.$tab=$("#content");company.methods.getReviews();}},methods:{getReviews:function(){var $tab=company.elements.$tab,$wrapper=$tab.find(".reviews-section"),$loader=$wrapper.find(".loader").hide(),$innerWrapper=$wrapper.find(".content-wrap"),id=$wrapper.attr("data-id");$innerWrapper.html("");$.ajax({url:tff.baseUrl+'/api/company/reviews-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',"Id":id},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($innerWrapper).fadeIn(400);resizeTabContent();company.methods.initReviews();},error:function(xhr){$loader.hide();$innerWrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initReviews:function(){var $tab=company.elements.$tab,$wrapper=$tab.find(".reviews-section");company.methods.initStars($wrapper);},initStars:function($wrapper){$wrapper.find('.star-rating').each(function(){var star=$(this).attr('id').split('result')[1];var m=($(this).hasClass('form'))?36:18;$(this).css("background-position","0 -"+(star*m)+"px");});}}};var resizeTabContent=function(){}
company.init();}};tff['co-reg']={start:function(){var $emailPersonal=$('[name="Email"]'),$emailCompany=$('[name="Company_Email"]');$emailPersonal.bind("change",function(){$emailCompany.val($emailPersonal.val());});$emailPersonal.bind("keyup",function(){$emailCompany.val($emailPersonal.val());});}};tff['lawn-create']={start:function(){var a=$('#new_Address1');var c=$('#new_City');var s=$('#new_State');var p=$('#new_PostalCode');var lat=$('#new_Latitude');var lng=$('#new_Longitude');$('#newLawn_form').on('change','input, select',function(){if(a.val().length&&c.val().length&&s.val().length&&p.val().length){tff.geocodeAddress(a.val()+', '+c.val()+', '+s.val()+', '+p.val(),function(geo){if(geo&&geo.length==2){lat.val(geo[0]);lng.val(geo[1]);}});}});}};tff['lawn-edit']={start:function(){var a=$('#upd_Address1');var c=$('#upd_City');var s=$('#upd_State');var p=$('#upd_PostalCode');var lat=$('#upd_Latitude');var lng=$('#upd_Longitude');$('#updateLawn_form').on('change','input, select',function(){if(a.val().length&&c.val().length&&s.val().length&&p.val().length){tff.geocodeAddress(a.val()+', '+c.val()+', '+s.val()+', '+p.val(),function(geo){if(geo&&geo.length==2){lat.val(geo[0]);lng.val(geo[1]);}});}});}};tff['cust-reg']={start:function(){$('input.date, input.datepicker').datepicker({minDate:+1});var grass={elements:{},options:{currentStep:0,numSteps:3,stepOffset:-5,grassBitsDensity:1,grassBitsNumTypes:4,cutDuration:2000},methods:{init:function(){if(!grass.elements.$wrap){grass.elements.$wrap=$(".grass-wrap");grass.elements.$grass=grass.elements.$wrap.find(".tall-grass");grass.elements.$mower=grass.elements.$wrap.find(".mower-wrap");grass.elements.$wrap.find(".grassbit").remove();}},cut:function(step,callback){if(step<grass.options.currentStep){return;}
var options=grass.options,$wrap=grass.elements.$wrap,$grass=grass.elements.$grass,$mower=grass.elements.$mower,wrapWidth=$wrap.css("width"),oldWidth=$grass.css("width"),stepSize=100/options.numSteps,newWidth=100-(step*stepSize)+(options.stepOffset),start=100;if(newWidth<15){newWidth=0;}
start=(parseFloat(oldWidth.replace("px",""))/parseFloat(wrapWidth.replace("px","")))*100;TweenMax.to($grass,(options.cutDuration/1000),{"width":newWidth+"%"});TweenMax.to($mower,(options.cutDuration/1000),{"right":newWidth+"%"});var $grassbits=grass.methods.buildGrassBits(start,newWidth),numGrassBits=$grassbits.length,$grassbits2=grass.methods.buildGrassBits(start,newWidth),numGrassBits2=$grassbits2.length,$grassbits3=grass.methods.buildGrassBits(start,newWidth),numGrassBits3=$grassbits3.length,$grassbits4=grass.methods.buildGrassBits(start,newWidth),numGrassBits4=$grassbits4.length;TweenMax.staggerTo($grassbits,(options.cutDuration/10000),{"bottom":120,"right":"+=10%","rotationZ":"-360deg","scale":1.5},((options.cutDuration/numGrassBits)/1300));TweenMax.staggerTo($grassbits2,(options.cutDuration/10000),{"bottom":115,"right":"+=9%","rotationZ":"360deg","scale":1.3},((options.cutDuration/numGrassBits2)/1300));TweenMax.staggerTo($grassbits3,(options.cutDuration/10000),{"bottom":130,"right":"+=12%","rotationZ":"180deg","scale":1.2},((options.cutDuration/numGrassBits3)/1300));TweenMax.staggerTo($grassbits4,(options.cutDuration/10000),{"bottom":125,"right":"+=3%","rotationZ":"270deg","scale":1.6},((options.cutDuration/numGrassBits4)/1300));setTimeout(function(){TweenMax.staggerTo($grassbits,(options.cutDuration/10000),{"bottom":0,"right":"+=5%","rotationZ":"-=360deg","scale":1,"opacity":0,onComplete:function(){$(this.target).remove()}},((options.cutDuration/numGrassBits)/1300));TweenMax.staggerTo($grassbits2,(options.cutDuration/10000),{"bottom":0,"right":"+=6%","rotationZ":"+=360deg","scale":.9,"opacity":0,onComplete:function(){$(this.target).remove()}},((options.cutDuration/numGrassBits2)/1300));TweenMax.staggerTo($grassbits3,(options.cutDuration/10000),{"bottom":0,"right":"+=7%","rotationZ":"+=270deg","scale":.8,"opacity":0,onComplete:function(){$(this.target).remove()}},((options.cutDuration/numGrassBits3)/1300));TweenMax.staggerTo($grassbits4,(options.cutDuration/10000),{"bottom":0,"right":"+=8%","rotationZ":"+=270deg","scale":.9,"opacity":0,onComplete:function(){$(this.target).remove()}},((options.cutDuration/numGrassBits4)/1300));},(options.cutDuration/9000));grass.options.currentStep=step;},buildGrassBits:function(start,stop){var options=grass.options,$wrap=grass.elements.$wrap,$grass=grass.elements.$grass;for(var i=start,j=0;i>stop;i=i-options.grassBitsDensity,j++){$('<div class="grassbit new"></div>').addClass("gBit_"+((j%options.grassBitsNumTypes)+1)).css({"bottom":0,"right":i+"%"}).appendTo($wrap);}
return $wrap.find(".grassbit.new").removeClass("new");}}};$(document).ready(function(){grass.methods.init();});function stepIn(next,prev,dir){$(next).animate({left:dir,opacity:1},function(){var $this=$(this);$this.find('.startHere').first().focus();}).addClass('current');}
function stepOut(next,prev,dir){$(prev).animate({left:dir,opacity:0}).removeClass('current');}
function animHeight(h){$('#steps').animate({height:(h+50)+'px'});}
$('.regStep.current').css('left','0');var doc=document.documentElement,body=document.body;var scrollTo=(doc&&doc.scrollTop||body&&body.scrollTop||0);var goToStep=function(href){tff.debug("goToStep");if(!$(href).length){href="#step1";}
var next=href,nextNum=next.substring(5),h=$(next).height(),prev=$('#stepsNav a.active').attr('href');if(next!=prev){if(nextNum>prev.substring(5)){dir='0';}else{dir='20px';}
$('#stepsNav a').removeClass('active').end().find('a[href='+next+']').addClass('active');animHeight(h);grass.methods.cut(nextNum-1);stepOut(next,prev,dir);stepIn(next,prev,dir);if(doc){doc.scrollTop=scrollTo;}
if(body){$("body").animate({scrollTop:scrollTo},0);}}
var p=$(this).parents('.regStep');if(p.is('#step1')){var d=p.find('#new_ServiceDate').val();var a=p.find('#new_Address1').val();var c=p.find('#new_City').val();if(d.length){$('#ServiceDate').val(d);}
if(a.length){$('#Address1').val(a);}
if(c.length){$('#City').val(c);}}};$(window).on('hashchange.cust-reg',function(){var hash=window.location.hash,goTo="#step1";if(hash.length){goTo=hash;}
if(goTo=="#step1"){grass.methods.cut(0);}
goToStep(goTo);});$('#steps a.continue, #stepsNav a').click(function(e){var doc=document.documentElement,body=document.body,scrollTo=(doc&&doc.scrollTop||body&&body.scrollTop||0);e.preventDefault();var next=$(this).attr('href');window.location.hash=next;});animHeight($('#step1').height());$('#Email').blur(function(){var email=$(this).val();$('#userName').text(email);});var a=$('#Address1');var c=$('#City');var s=$('#State');var p=$('#PostalCode');var lat=$('#Latitude');var lng=$('#Longitude');$('#customerReg_form').on('submit',function(){var f=$(this);setTimeout(function(){var steps=$('.regStep:has(.ketchup-validation-error):first',f);if(steps.length){$('a[href="#'+steps.attr('id')+'"]').click();}else{grass.methods.cut(3);}},150);});var latStart=36.16491,lngStart=-86.77806,$tab=$("#step2"),$mapWrap=$tab.find(".map-wrap");if(typeof(ud)!=='undefined'){latStart=ud.Latitude;lngStart=ud.Longitude;}
var data=$("#customerReg_form").data("ud");var updateFormFromZipTimeout=0,updateFormFromZipTimeoutDelay=500,updateFormFromZip=function(zip){clearTimeout(updateFormFromZipTimeout);updateFormFromZipTimeout=setTimeout(function(){var gc=new google.maps.Geocoder();if(!zip||!zip.length){return;}
gc.geocode({'address':zip},function(results,status){if(!results[0]||!results[0].address_components){return;}
var d=data;if(!d){d={};}
data=d;$.each(results[0].address_components,function(){var self=this,type=self.types[0],val=self["long_name"];switch(type){case"postal_code":data["Lawn_PostalCode"]=val;break;case"locality":data["Lawn_City"]=val;break;case"administrative_area_level_1":data["Lawn_State"]=val;break;default:break;}});tff.prefillFromRequest(data,'#customerReg_form');$("select").each(function(){var self=this,$this=$(self);if($this.is(".selectBox")){$this.selectBox("refresh");}});});},updateFormFromZipTimeoutDelay);};var latlng=new google.maps.LatLng(latStart,lngStart),lawnMapOptions={center:latlng,zoom:19,mapTypeId:google.maps.MapTypeId.SATELLITE,streetViewControl:false},lawn_map=new google.maps.Map($mapWrap.find(".lawn_map")[0],lawnMapOptions),streetMapOptions={position:new google.maps.LatLng(lat,lng),pov:{heading:0,pitch:0,zoom:1}},street_map=new google.maps.StreetViewPanorama(document.getElementById("street_map"),streetMapOptions);var markerOptions={map:lawn_map,position:latlng},marker=new google.maps.Marker(markerOptions);var changeTimeoutDelay=500,changeTimeout=0,$mapChange=$("#Address1,#City,#State,#PostalCode");$mapChange.bind("change.update-map",function(e){var street=$tab.find("#Address1").val(),city=$tab.find("#City").val(),state=$tab.find("#State").val(),zip=$tab.find("#PostalCode").val(),valOut=street+", "+city+", "+state+" "+zip;clearTimeout(changeTimeout);changeTimeout=setTimeout(function(){tff['cust-reg'].updateLawnMap(valOut,function(geo){if(geo&&geo.length==2){lat.val(geo[0]);lng.val(geo[1]);var latlng=new google.maps.LatLng(geo[0],geo[1]);lawnMapOptions["center"]=latlng;lawn_map.setOptions(lawnMapOptions);streetMapOptions["position"]=latlng;street_map.setPosition(streetMapOptions["position"]);marker.setPosition(latlng);}});},changeTimeoutDelay);});setTimeout(function(){tff.debug("change map");if(data&&data["Zip_Only"]&&data["Zip_Only"].length){updateFormFromZip(data["Zip_Only"]);}else{$mapChange.first().trigger("change");}},1000);var syncTabFields=function(){$("#new_ServiceDate").bind("change.syncTab2",function(){var $this=$(this),$other=$("#ServiceDate");$other.val($this.val());}).trigger("change.syncTab2");$("#new_Address1").bind("change.syncTab2",function(){var $this=$(this),$other=$("#Address1");$other.val($this.val());}).trigger("change.syncTab2");$("#new_City").bind("change.syncTab2",function(){var $this=$(this),$other=$("#City");$other.val($this.val());});$("#new_zip").bind("change.syncTab2",function(){var $this=$(this),$other=$("#PostalCode");$other.val($this.val());updateFormFromZip($this.val());});$("#ServiceDate").bind("change.syncTab1",function(){var $this=$(this),$other=$("#new_ServiceDate");$other.val($this.val());});$("#Address1").bind("change.syncTab1",function(){var $this=$(this),$other=$("#new_Address1");$other.val($this.val());});$("#City").bind("change.syncTab1",function(){var $this=$(this),$other=$("#new_City");$other.val($this.val());});$("#PostalCode").bind("change.syncTab1",function(){var $this=$(this),$other=$("#new_zip");$other.val($this.val());});}();},updateLawnMap:function(address,callback){if(!address||!address.length){return;}
tff.geocodeAddress(address,function(geo){if($.isFunction(callback)){callback(geo);}});}};tff['cust-dash']={start:function(){if($.support.transition){$("html").addClass("transition");}
var $window=$(window),newAuct=$('#newAuctionDialog').hide().find('form');$('#new_Auction, .new-auction').on('click',function(){var $this=$(this),modal;if($this.is(".inactive")){return false;}
modal=tff.showModal("Create New Auction",newAuct,{beforeOpen:function(m){m.find('.modalOk').hide();m.find('.modalCancel').hide();m.find("form").show();m.find(".date").datepicker("option","onClose",function(){var $this=$(this);$this.trigger("blur");});},afterClose:function(m){var $popup=m.find("form"),href=$popup.attr("id"),$wrap=$("#newAuctionDialog"),$link=$('#new_Auction');$popup.appendTo($wrap).hide();}});});tff.initConfirm();var adminUserCurrentId=0;if($("#adminUserCurrentId").length){adminUserCurrentId=$("#adminUserCurrentId").val();}
$('#slides').slides({preload:true,generateNextPrev:true,generatePagination:false});$('#slides img').click(function(){var thisSrc=$(this).attr('src');$('#mainImage').attr('src',thisSrc).parent().attr('href',thisSrc);});var scheduleMulti={"options":{animateDuration:500,wrapSelector:"#schedulemulti",linkSelector:'[href="#schedulemulti"]'},"init":function(){var o=scheduleMulti.options;if(!scheduleMulti.elements){scheduleMulti.elements={};}
var $wrap=scheduleMulti.elements.$wrap,$link=scheduleMulti.elements.$link;if(!$wrap){$wrap=scheduleMulti.elements.$wrap=$(o.wrapSelector);$wrap.data("modal-options",o).hide();}
if(!$link){$link=scheduleMulti.elements.$link=$(o.linkSelector);$link.bind("click.scheduleMulti",function(e){e.preventDefault();scheduleMulti.methods.show($wrap);return false;});}},"methods":{show:function($popup,callback){if(!$popup.length){return;}
scheduleMulti.methods.getForm({},function(form){var $formWrap=$(form);$formWrap.find('input.date').datepicker({minDate:+1});$popup.html("").append($formWrap);var $modal=tff.showModal("",$popup,{beforeOpen:function(m){m.find('.modalOk').hide();m.find('.modalCancel').hide();},afterClose:function(m){},afterRemove:function(){}});$popup.show();$modal.trigger("open");});},hide:function($popup,callback){if(!$popup.length){return;}
$popup.trigger("close.modal");},getForm:function(opts,callback){$.ajax({url:tff.baseUrl+'/api/appointment/create-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc'},beforeSend:function(){$("body").css("cursor","progress");},success:function(html){var htmlOut=html;$("body").css("cursor","default");if(!html.length&&(!html.Error&&!html.Success)){if($.isFunction(callback)){callback("<h2>No data</h2>");return;}}
if(html.Error&&html.Error.length){tff.addMessage({type:"e","message":html.Error});return;}
if(html.Success&&html.Success.length){htmlOut="<p>"+html.Success+"</p>";}
if($.isFunction(callback)){callback(htmlOut);}},error:function(xhr){}});}}};scheduleMulti.init();var tabs=tff['cust-dash'].tabs={"dashboard":{"init":function(){if(!tabs.dashboard.elements){tabs.dashboard.elements={};}
tabs.dashboard.elements.$tab=$("#tabs #dashboard");$('.shedule-appointment').on("click",function(){var $appointmentWrap=$(".appointment-wrap"),$ctas=$appointmentWrap.find(".ctas"),$form=$appointmentWrap.find(".form"),$closeButton=$appointmentWrap.find(".close-form"),animateDuration=400;if($form.is(".active")){$form.removeClass("active");$form.fadeIn(animateDuration);$appointmentWrap.animate({"height":"145px",'boxShadowBlur':'0px'},animateDuration);$closeButton.fadeOut(animateDuration);}else{$form.addClass("active");$form.fadeIn(animateDuration);$appointmentWrap.animate({"height":$form.height()-20,'boxShadowBlur':'20px'},animateDuration);$closeButton.fadeIn(animateDuration);}});$(".appointment-wrap").find(".close-form").on("click",function(){var $appointmentWrap=$(".appointment-wrap"),$ctas=$appointmentWrap.find(".ctas"),$form=$appointmentWrap.find(".form"),$closeButton=$appointmentWrap.find(".close-form"),animateDuration=400;var testNoTransitions=true;$form.removeClass("active");$form.fadeOut(animateDuration);$appointmentWrap.animate({"height":"130px",'boxShadowBlur':'0px'},animateDuration);$closeButton.fadeOut(animateDuration);});tabs.dashboard.methods.initAppointmentForm();tabs.dashboard.methods.initLatestAccountActivity();},"methods":{initAppointmentForm:function(){var $appointmentForm=$(".appointment-wrap").find("form");var $datepicker=$appointmentForm.find(".datepicker").datepicker();$datepicker.datepicker("option","onClose",function(){var $this=$(this);$this.trigger("blur");});},initLatestAccountActivity:function(callback){var $wrapper=$(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),liveIntervalDelay=(1000*60*5);$.ajax({url:tff.baseUrl+'/api/notification/type',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',currentUserOnly:true,Id:(adminUserCurrentId)?adminUserCurrentId:""},dataType:'json',success:function(d){var types=d["Types"],i=0,thisId=0,length=types.length,$ul=$("<ul class='filter-list'></ul>"),thisType,$li,thisHtml,itemSpacer="&nbsp;/&nbsp;";if($(".filter-list").not($ul).length){$(".filter-list").remove();}
$li=$("<li></li>").data("data-type","all").data("data-typeId",-1).attr("data-type","all").attr("data-typeId",-1).html('<a href="#dashboard/activity/-1">All</a>').appendTo($ul);if(length){for(i=0;i<length;i++){thisType=types[i];thisId=(!!thisType.id)?thisType.id:i;thisHtml='<a href="#dashboard/activity/'+thisId+'">'+thisType.title+'</a>';thisHtml=itemSpacer+thisHtml;$li=$("<li></li>").data("data-type",thisType.title).data("data-typeId",thisId).attr("data-type",thisType.title).attr("data-typeId",thisId).html(thisHtml).appendTo($ul);}
$filterList=$ul.appendTo(".filter-wrap");}
tabs.dashboard.methods.setCountNotifications();setInterval(function(){tabs.dashboard.methods.setCountNotifications();},liveIntervalDelay);var setNewNotifications=function(){var typeId=$listWrap.attr("data-typeId"),$firstLi=$listWrap.children("ul").children("li").first(),latestId=$firstLi.attr("data-id");$.ajax({url:tff.baseUrl+'/api/notification/activity',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':typeId,'firstId':latestId},beforeSend:function(){},success:function(data){var $ul=$(data),$li=$ul.find("li"),firstLiTop=75*$li.length;if(!$li.length){return false;}
$firstLi.animate({"margin-top":firstLiTop+"px"},400,function(){$li.css({"display":"none"}).insertBefore($firstLi).fadeIn(400);$firstLi.css("margin-top",0);resizeTabContent();});},error:function(xhr){}});};setInterval(function(){setNewNotifications();},liveIntervalDelay);if($.isFunction(callback)){callback();}},error:function(xhr){tff.nError("There was a problem. Please contact the webmaster for assistance.");}});var scrollTimeout,scrollDelay=100;var checkScrollPos=function(){var curY=window.scrollY,windowHeight=$(window).height(),top=$listWrap.offset().top,height=$listWrap.height(),bottom=top+height,typeId=$listWrap.attr("data-typeId"),$lastItem=$listWrap.find(".notifyItem").last(),searchTerm=$wrapper.find(".notification-search").val();if(((windowHeight+curY)>bottom)&&!$listWrap.find(".no-more-notifications").length){$.ajax({url:tff.baseUrl+'/api/notification/activity',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':typeId,'lastId':$lastItem.attr("data-id"),'search':searchTerm,Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.stop().fadeIn(400);},success:function(html){$loader.stop().fadeOut(400);var $ul=$(html),$items=$ul.children("li");if($items.length){$items.insertAfter($lastItem);}else{if(!$listWrap.find(".no-more-notifications").length){$ul.appendTo($listWrap);}}
resizeTabContent();},error:function(xhr){tff.nError("There was a problem getting notifications. Please contact the webmaster for assistance.");}});}};$window.scroll(function(){clearTimeout(scrollTimeout);scrollTimeout=setTimeout(function(){checkScrollPos();},scrollDelay);});$wrapper.find(".refresh").bind("click",function(){$window.trigger("hashchange");});var keyupTimeout=0,keyupTimeoutDelay=600;$wrapper.find(".notification-search").bind("keyup",function(e){clearTimeout(keyupTimeout);var $this=$(this);if($this.val().length){$wrapper.find(".markasread").addClass("disabled");}else{$wrapper.find(".markasread").removeClass("disabled");}
keyupTimeout=setTimeout(function(){$wrapper.find(".refresh").trigger("click");},keyupTimeoutDelay);});$wrapper.find(".markasread").bind("click",function(e){var self=this,$this=$(self),$target=$(e.target);if($this.is(".disabled")){return false;}
e.preventDefault();tabs.dashboard.methods.markNotificationsAsRead();});},setCountNotifications:function(){var $wrapper=$(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$existingBoxes=$(".count-box");$filterList.find("li").each(function(){var $this=$(this),typeId=$this.attr("data-typeId"),curData;if(typeId==-1){$this=$('.tabNav a[href="#dashboard"]').closest("li").css("position","relative");}
TweenMax.to($existingBoxes,0.3,{"opacity":"0","margin-top":"-10px","onComplete":function(){$existingBoxes.remove();}});$.ajax({url:tff.baseUrl+'/api/notification/activity_count',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':typeId,Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){},success:function(data){var $countBox=$this.find(".count-box");if(!$countBox.length){if(parseInt(data)<=0){return false;}
$countBox=$('<div class="count-box"></div>').css({"opacity":"0","margin-top":"-10px"}).html(data).appendTo($this).animate({"opacity":"1","margin-top":"0px"},300);}else{curData=$this.find(".count-box").html();if(parseInt(data)<=0){$countBox.animate({"margin-top":"-10px","opacity":0},300,function(){$countBox.remove();});}else if(curData!=data){$countBox.animate({"margin-top":"-10px"},100,function(){$countBox.animate({"margin-top":"0px"},100);});}}
$countBox.html(data);},error:function(xhr){}});});},onHashChanged:function(hashAr){tabs.dashboard.methods.getLatestAccountActivity(hashAr);},showSearch:function(callback){var $tab=tabs.dashboard.elements.$tab,$toShow=$tab.find(".notification-actions .action"),$listWrap=$tab.find(".list-wrap");TweenMax.to($listWrap,.5,{"y":0});TweenMax.to($toShow.show(),.5,{"opacity":1,"y":0,"onComplete":function(){if($.isFunction(callback)){callback();}}});},hideSearch:function(callback){var $tab=tabs.dashboard.elements.$tab,$toHide=$tab.find(".notification-actions .action"),$searchField=$tab.find(".notification-search"),$listWrap=$tab.find(".list-wrap"),toHideTallest=$toHide.first().height()/2;$searchField.val("");TweenMax.to($listWrap,.5,{"y":-1*toHideTallest});TweenMax.to($toHide,.5,{"opacity":0,"y":-1*toHideTallest,"onComplete":function(){$toHide.hide();if($.isFunction(callback)){callback();}}});},markNotificationsAsRead:function(){var $tab=tabs.dashboard.elements.$tab,$wrapper=$tab.find(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),searchTerm=$wrapper.find(".notification-search").val(),hash=window.location.hash.replace("#",""),hashAr=hash.split("/"),hashLen=hashAr.length,category=(hashLen)?hashAr.shift():"activity",val=(hashAr.length)?hashAr.shift():"-1",current=$filterList.data('currentLocation');$.ajax({url:tff.baseUrl+'/api/notification/activity',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':val,'search':searchTerm,'action':"readall",Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.stop().fadeIn(400);},success:function(ret){if(!!ret){if(ret.Success&&ret.Success.length){tff.nSuccess(ret.Success);}
if(ret.Info&&ret.Info.length){tff.nInfo(ret.Info);}
if(ret.Error&&ret.Error.length){tff.nError(ret.Error);}}
$wrapper.find(".refresh").trigger("click");},error:function(xhr){}});},getLatestAccountActivity:function(hashAr,ignoreHash){var $tab=tabs.dashboard.elements.$tab,$wrapper=$tab.find(".latest-activity-wrap"),$filterList=$wrapper.find(".filter-list"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),searchTerm=$wrapper.find(".notification-search").val();var hashLen=hashAr.length,category=(hashLen)?hashAr.shift():"activity",val=(hashAr.length)?hashAr.shift():"-1",current=$filterList.data('currentLocation');if(parseInt(val)==-1){tabs.dashboard.methods.showSearch();}else{tabs.dashboard.methods.hideSearch();searchTerm="";}
$.ajax({url:tff.baseUrl+'/api/notification/activity',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','typeId':val,'search':searchTerm,Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$listWrap.fadeOut(400);$filterList.find("li").removeClass("active");$filterList.find('li[data-typeId="'+val+'"]').addClass('active');$listWrap.attr("data-typeId",val);$loader.stop().fadeIn(400);},success:function(html){$loader.stop().fadeOut(400);$listWrap.html(html);$listWrap.fadeIn(400);resizeTabContent();tabs.dashboard.methods.setCountNotifications();},error:function(xhr){}});}}},"appointments":{init:function(){if(!tabs.appointments.elements){tabs.appointments.elements={};tabs.appointments.elements.$tab=$("#tabs #appointments");tabs.appointments.elements.$tab.on("click.appointments-paging",".paging a",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),href=$target.attr("href"),pageTo=1,hrefAr=href.split("?"),$section=$target.closest(".appointments-section"),$table=$section.find(".userTable"),listType=$table.attr("data-listtype"),pagingVar=tabs.appointments.methods.getPagingVar(listType);if(hrefAr.length>1){hrefAr=hrefAr[1].split("&");for(var i=0;i<hrefAr.length;i++){hrefAr[i]=hrefAr[i].split("=");}
for(var i=0;i<hrefAr.length;i++){if(hrefAr[i][0]==pagingVar){pageTo=hrefAr[i][1];continue;}}}
tff.pageTable($section,$table.closest(".table-wrap"),$table,'/api/customer/appointments-ajax',pagingVar,pageTo);});tabs.appointments.elements.$tab.on("click.appointments-sorting","[data-sort]",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),sortBy=$target.attr("data-sort"),pageTo=1,$section=$target.closest(".appointments-section"),$table=$section.find(".userTable"),$tableWrap=$table.closest(".table-wrap"),listType=$table.attr("data-listtype"),pagingVar=tabs.appointments.methods.getPagingVar(listType);if($tableWrap.attr("sortBy")!=sortBy){$tableWrap.removeAttr("sortDir");}
if(sortBy){$tableWrap.attr("sortBy",sortBy);if(!$tableWrap.attr("sortDir")){$tableWrap.attr("sortDir","ASC");}else if($tableWrap.attr("sortDir")=="ASC"){$tableWrap.attr("sortDir","DESC");}else{$tableWrap.removeAttr("sortDir");$tableWrap.removeAttr("sortBy");}}
tff.pageTable($section,$tableWrap,$table,'/api/customer/appointments-ajax',pagingVar,pageTo);});}else{tabs.appointments.methods.initAppointmentsToday();tabs.appointments.methods.initAppointmentsNext5();tabs.appointments.methods.initAppointmentsOther();}},methods:{initAppointmentsToday:function(){var $tab=tabs.appointments.elements.$tab,$appointmentsWrap=$tab.find(".appointments-today-wrap"),$loader=$appointmentsWrap.find(".loader").hide(),$wrapper=$appointmentsWrap.find(".appointments-today");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/customer/appointments-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',listType:'today'},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initAppointmentsNext5:function(){var $tab=tabs.appointments.elements.$tab,$appointmentsWrap=$tab.find(".appointments-next5-wrap"),$loader=$appointmentsWrap.find(".loader").hide(),$wrapper=$appointmentsWrap.find(".appointments-next5");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/customer/appointments-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',listType:'nextfive'},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initAppointmentsOther:function(){var $tab=tabs.appointments.elements.$tab,$appointmentsWrap=$tab.find(".appointments-other-wrap"),$loader=$appointmentsWrap.find(".loader").hide(),$wrapper=$appointmentsWrap.find(".appointments-other");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/customer/appointments-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',listType:'allappts'},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},hideSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.removeClass("active");$tableWrap.animate({"height":"0"},400);$paginationWrap.fadeOut(400);},showSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.addClass("active");$tableWrap.animate({"height":$tableWrap.find("table").first().outerHeight()},400);$paginationWrap.fadeIn(400);},onHashChanged:function(hashAr){tabs.appointments.init();},getPagingVar:function(listType){var pagingVar="all_page";switch(listType){case"today":pagingVar="today_page";break;case"nextfive":pagingVar="next_page";break;case"allappts":default:pagingVar="all_page";break;}
return pagingVar;}}},"account":{init:function(){if(!tabs.account.elements){tabs.account.elements={};tabs.account.elements.$tab=$("#tabs #account");}else{tabs.account.methods.getAccount();}},methods:{onHashChanged:function(hashAr){tabs.account.init();},getAccount:function(){var $tab=tabs.account.elements.$tab,$accountWrap=$tab.find(".account-wrap"),$loader=$accountWrap.find(".loader").hide(),$wrapper=$accountWrap.find(".account-section");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/user/edit-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();tabs.account.methods.initAccount();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initAccount:function(){var $tab=tabs.account.elements.$tab;$tab.find(':text, :password').addClass('text');$tab.find('.watermark').each(function(){var a=$(this).attr('alt');if(a&&a.length){$(this).watermark(a).blur();}});$tab.find('.startHere:first').focus();$tab.find('input.url').blur(function(){if($(this).val().length&&!/^http/.test($(this).val())){$(this).val('http://'+$(this).val());}});$tab.find('form.validate').ketchup(tff.ketchupOptions);$tab.find('body').on('fieldValidationFailed.ketchup','div.group.hasNote input, div.group select, div.group.hasNote textarea',function(){$(this).parents('.group').append($(this).siblings('.ketchup-error-container'));});$tab.find('.ketchup-error-container').hover(function(){$(this).find('.ketchupMessage').stop().fadeTo(500,1);},function(){$(this).find('.ketchupMessage').stop().fadeTo(500,0);});$tab.find('a[title], .toolTipBase').simpleTip();$tab.find(':button, :submit').not('.magnifier').not(".no-button").addClass('button');tabs.account.methods.submitAccountForm($tab.find("form"));},submitAccountForm:function($form){var $tab=tabs.account.elements.$tab,dataOut=$form.serialize(),$loader=$form.find(".spinner");$form.ajaxForm({beforeSubmit:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();tff.nSuccess("Your lawn has been updated");},error:function(xhr){$loader.hide();tff.nError("There was a problem submitting the form. Please contact the webmaster for assistance.");}});}}},"auctions":{init:function(){if(!tabs.auctions.elements){tabs.auctions.elements={};tabs.auctions.elements.$tab=$("#tabs #auctions");tabs.auctions.elements.$tab.on("click.auctions-paging",".paging a",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),href=$target.attr("href"),pageTo=1,hrefAr=href.split("?"),$section=$target.closest(".auctions-section"),$table=$section.find(".userTable"),listType=$table.attr("data-listtype"),pagingVar=tabs.auctions.methods.getPagingVar(listType);if(hrefAr.length>1){hrefAr=hrefAr[1].split("&");for(var i=0;i<hrefAr.length;i++){hrefAr[i]=hrefAr[i].split("=");}
for(var i=0;i<hrefAr.length;i++){if(hrefAr[i][0]==pagingVar){pageTo=hrefAr[i][1];continue;}}}
tff.pageTable($section,$table.closest(".table-wrap"),$table,'/api/auction/all-ajax',pagingVar,pageTo);});tabs.auctions.elements.$tab.on("click.auctions-sorting","[data-sort]",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),sortBy=$target.attr("data-sort"),pageTo=1,$section=$target.closest(".auctions-section"),$table=$section.find(".userTable"),$tableWrap=$table.closest(".table-wrap"),listType=$table.attr("data-listtype"),pagingVar=tabs.auctions.methods.getPagingVar(listType);if($tableWrap.attr("sortBy")!=sortBy){$tableWrap.removeAttr("sortDir");}
if(sortBy){$tableWrap.attr("sortBy",sortBy);if(!$tableWrap.attr("sortDir")){$tableWrap.attr("sortDir","ASC");}else if($tableWrap.attr("sortDir")=="ASC"){$tableWrap.attr("sortDir","DESC");}else{$tableWrap.removeAttr("sortDir");$tableWrap.removeAttr("sortBy");}}
tff.pageTable($section,$tableWrap,$table,'/api/auction/all-ajax',pagingVar,pageTo);});}else{tabs.auctions.methods.initAuctions();}},methods:{initAuctions:function(){var $tab=tabs.auctions.elements.$tab,$auctionsWrap=$tab.find(".auctions-wrap"),$loader=$auctionsWrap.find(".loader").hide(),$wrapper=$auctionsWrap.find(".auctions-section");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/auction/all-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc'},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},hideSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.removeClass("active");$tableWrap.animate({"height":"0"},400);$paginationWrap.fadeOut(400);},showSection:function($section){var $tableWrap=$section.find(".table-wrap"),$paginationWrap=$section.find(".pagination-wrap");$section.addClass("active");$tableWrap.animate({"height":$tableWrap.find("table").first().outerHeight()},400);$paginationWrap.fadeIn(400);},onHashChanged:function(hashAr){tabs.auctions.init();},getPagingVar:function(listType){var pagingVar="page";return pagingVar;}}},"payments":{init:function(){if(!tabs.payments.elements){tabs.payments.elements={};tabs.payments.elements.$tab=$("#tabs #payments");tabs.payments.elements.$tab.on("click.payments-paging",".paging a",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),href=$target.attr("href"),pageTo=1,hrefAr=href.split("?"),$section=$target.closest(".payments-section"),$table=$section.find(".userTable"),listType=$table.attr("data-listtype"),pagingVar=tabs.payments.methods.getPagingVar(listType);if(hrefAr.length>1){hrefAr=hrefAr[1].split("&");for(var i=0;i<hrefAr.length;i++){hrefAr[i]=hrefAr[i].split("=");}
for(var i=0;i<hrefAr.length;i++){if(hrefAr[i][0]==pagingVar){pageTo=hrefAr[i][1];continue;}}}
tff.pageTable($section,$table.closest(".table-wrap"),$table,'/api/payment/all-ajax',pagingVar,pageTo);});tabs.payments.elements.$tab.on("click.payments-sorting","[data-sort]",function(e){e.preventDefault();var self=this,$this=$(self),$target=$(e.target),sortBy=$target.attr("data-sort"),pageTo=1,$section=$target.closest(".payments-section"),$table=$section.find(".userTable"),$tableWrap=$table.closest(".table-wrap"),listType=$table.attr("data-listtype"),pagingVar=tabs.payments.methods.getPagingVar(listType);if($tableWrap.attr("sortBy")!=sortBy){$tableWrap.removeAttr("sortDir");}
if(sortBy){$tableWrap.attr("sortBy",sortBy);if(!$tableWrap.attr("sortDir")){$tableWrap.attr("sortDir","ASC");}else if($tableWrap.attr("sortDir")=="ASC"){$tableWrap.attr("sortDir","DESC");}else{$tableWrap.removeAttr("sortDir");$tableWrap.removeAttr("sortBy");}}
tff.pageTable($section,$tableWrap,$table,'/api/payment/all-ajax',pagingVar,pageTo);});}else{tabs.payments.methods.initPayments();}},methods:{initPayments:function(){var $tab=tabs.payments.elements.$tab,$paymentsWrap=$tab.find(".payments-wrap"),$loader=$paymentsWrap.find(".loader").hide(),$wrapper=$paymentsWrap.find(".payments-section");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/payment/all-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},onHashChanged:function(hashAr){tabs.payments.init();},getPagingVar:function(listType){var pagingVar="payment_page";return pagingVar;}}},"lawn":{init:function(){if(!tabs.lawn.elements){tabs.lawn.elements={};tabs.lawn.elements.$tab=$("#tabs #lawn");}else{tabs.lawn.methods.getLawn();}},methods:{onHashChanged:function(hashAr){tabs.lawn.init();},getLawn:function(){var $tab=tabs.lawn.elements.$tab,$lawnWrap=$tab.find(".lawn-wrap"),$loader=$lawnWrap.find(".loader").hide(),$wrapper=$lawnWrap.find(".lawn-section");$wrapper.html("");$.ajax({url:tff.baseUrl+'/api/lawn/edit-ajax',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc',Id:(adminUserCurrentId)?adminUserCurrentId:""},beforeSend:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();var $html=$(html).hide().appendTo($wrapper).fadeIn(400);resizeTabContent();tabs.lawn.methods.initLawn();},error:function(xhr){$loader.hide();$wrapper.html("There was a problem. Please contact the webmaster for assistance.");}});},initLawn:function(){var $tab=tabs.lawn.elements.$tab;$tab.find(':text, :password').addClass('text');$tab.find('.watermark').each(function(){var a=$(this).attr('alt');if(a&&a.length){$(this).watermark(a).blur();}});$tab.find('.startHere:first').focus();$tab.find('input.url').blur(function(){if($(this).val().length&&!/^http/.test($(this).val())){$(this).val('http://'+$(this).val());}});$tab.find('form.validate').ketchup(tff.ketchupOptions);$tab.find('body').on('fieldValidationFailed.ketchup','div.group.hasNote input, div.group select, div.group.hasNote textarea',function(){$(this).parents('.group').append($(this).siblings('.ketchup-error-container'));});$tab.find('.ketchup-error-container').hover(function(){$(this).find('.ketchupMessage').stop().fadeTo(500,1);},function(){$(this).find('.ketchupMessage').stop().fadeTo(500,0);});$tab.find('a[title], .toolTipBase').simpleTip();$tab.find(':button, :submit').not('.magnifier').not(".no-button").addClass('button');$tab.find(':checkbox').simpleImageCheck({image:tff.baseUrl+'/images/checkbox_unchecked.png',imageChecked:tff.baseUrl+'/images/checkbox_checked.png'});$tab.find(':radio').simpleImageCheck({image:tff.baseUrl+'/images/radio_unchecked.png',imageChecked:tff.baseUrl+'/images/radio_checked.png'});$tab.find('select').selectBox();tabs.lawn.methods.submitLawnForm($tab.find("form"));var lat=ud.Latitude,lng=ud.Longitude,$mapWrap=$tab.find(".map-wrap");var latlng=new google.maps.LatLng(lat,lng),lawnMapOptions={center:latlng,zoom:19,mapTypeId:google.maps.MapTypeId.SATELLITE,streetViewControl:false},lawn_map=new google.maps.Map($mapWrap.find(".lawn_map")[0],lawnMapOptions),streetMapOptions={position:latlng,pov:{heading:0,pitch:0,zoom:1}},street_map=new google.maps.StreetViewPanorama(document.getElementById("street_map"),streetMapOptions);var markerOptions={map:lawn_map,position:latlng},marker=new google.maps.Marker(markerOptions);$("#Address1,#City,#State,#PostalCode").bind("change.update-map",function(e){var street=$tab.find("#Address1").val(),city=$tab.find("#City").val(),state=$tab.find("#State").val(),zip=$tab.find("#PostalCode").val(),$lat=$tab.find("#Latitude"),$lng=$tab.find("#Longitude"),valOut=street+", "+city+", "+state+" "+zip;tff.geocodeAddress(valOut,function(geo){if(geo&&geo.length==2){$lat.val(geo[0]);$lng.val(geo[1]);var latlng=new google.maps.LatLng(geo[0],geo[1]);lawnMapOptions["center"]=new google.maps.LatLng(geo[0],geo[1]);lawn_map.setOptions(lawnMapOptions);streetMapOptions["position"]=new google.maps.LatLng(geo[0],geo[1]);street_map.setPosition(streetMapOptions["position"]);marker.setPosition(latlng);}});});},submitLawnForm:function($form){var $tab=tabs.lawn.elements.$tab,dataOut=$form.serialize(),$loader=$form.find(".spinner");$form.ajaxForm({beforeSubmit:function(){$loader.fadeIn(400);},success:function(html){$loader.hide();tff.nSuccess("Your lawn has been updated");},error:function(xhr){$loader.hide();tff.nError("There was a problem submitting the form. Please contact the webmaster for assistance.");}});}}}};var popups={"lawnmap":{elements:{},init:function(){if(!popups.lawnmap.elements.$wrap){var $wrap=popups.lawnmap.elements.$wrap=$(".map-wrap"),$closeButton=$('<div></div>').addClass("close-button").text("X").appendTo($wrap),$openButton=popups.lawnmap.elements.$openButton=$('[href="#lawnmap"]');var lat=$('#latitude').val();var lng=$('#longitude').val();$wrap.css("opacity",0).show();var latlng=new google.maps.LatLng(lat,lng),lawnMapOptions={center:latlng,zoom:19,mapTypeId:google.maps.MapTypeId.SATELLITE};var lawn_map=new google.maps.Map(document.getElementById("lawn_map"),lawnMapOptions);var markerOptions={map:lawn_map,position:latlng},marker=new google.maps.Marker(markerOptions);$wrap.hide().css("opacity",1);$closeButton.bind("click",function(){popups.lawnmap.methods.close();});}
popups.lawnmap.methods.open();},methods:{open:function(){var $wrap=popups.lawnmap.elements.$wrap,$openButton=popups.lawnmap.elements.$openButton;if(!$wrap){popups.lawnmap.init();}
$("body").bind("click.close-map",function(e){if(!$(e.target).closest(".map-wrap").length){e.preventDefault();popups.lawnmap.methods.close();}});$openButton.bind("click.close-map",function(e){e.preventDefault();popups.lawnmap.methods.close();});$wrap.css({"left":$openButton.offset().left-45}).fadeIn();},close:function(){var $wrap=popups.lawnmap.elements.$wrap,$openButton=popups.lawnmap.elements.$openButton;if(!$wrap){return;}
$("body").unbind("click.close-map");$openButton.unbind("click.close-map");if(window.location.hash.replace("#","").length){var doc=document.documentElement,body=document.body;var scrollTo=(doc&&doc.scrollTop||body&&body.scrollTop||0);window.location.hash="";$(window).trigger("hashchange");if(doc){doc.scrollTop=scrollTo;}
if(body){$("body").animate({scrollTop:scrollTo},0);}}
$wrap.fadeOut();}}}};function resizeTabContent(){$('#tabContent').stop().animate({'height':$('#tabContent .contentActive').height()});}
var transitionTab=function(tab){var $tabsWrapper=$("#tabs"),$navWrap=$tabsWrapper.find(".tabNav"),$thisNavLink=$navWrap.find('[href="#'+tab+'"]'),$thisTab=$("#"+tab),$activeContent=$tabsWrapper.find(".contentActive");if(!$thisNavLink.hasClass('active')){$navWrap.find("a").removeClass('active');$thisNavLink.addClass('active');$activeContent.fadeOut(400).removeClass("contentActive");$thisTab.fadeIn(400).addClass("contentActive");resizeTabContent();}};var hashChanged=function(){var hash=window.location.hash.replace("#",""),hashAr=hash.split("/"),hashArLength=hashAr.length,thisTab="dashboard",$thisTab,$thisNav;if(popups.lawnmap.elements.$wrap&&popups.lawnmap.elements.$wrap.is(":visible")){popups.lawnmap.methods.close();}
if(popups[hashAr[0]]){popups[hashAr[0]].init();}else if(tabs[hashAr[0]]){thisTab=hashAr.shift();}else if(hashAr[0]=="schedule-multi"){scheduleMulti.elements.$link.click();}
transitionTab(thisTab);tabs[thisTab].methods.onHashChanged(hashAr);};$window.on('hashchange.cust-dash',hashChanged).on('load',function(){$window.trigger('hashchange.cust-dash');});var $tabs=$("#tabs");$tabs.find(".content").hide();$tabs.find(".tabNav a").each(function(){var $this=$(this),tab=$this.attr("href").replace("#","");if(tabs[tab]){if($.isFunction(tabs[tab].init)){tabs[tab].init();}}});var handleAnimations=function(){var animations={"clouds":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.clouds.elements.$wrap=$("#clouds"),$img=animations.clouds.elements.$img=$wrap.find("div");animations.clouds.methods.start();},"start":function(callback){var $img=animations.clouds.elements.$img,$cloud1=$img.first(),$otherClouds=$cloud1.nextAll("div").hide();cloud3Left=0,cloud1Left=0,cloud1Width=300,cloud1Speed=.5,cloud3Speed=.3,opacitySpeed=.02,opacity=0,$window=$(window),windowWidth=$window.width(),framerate=60;$cloud1.addClass("cloud1").css({opacity:opacity,left:-1*cloud1Width,rotate:'.001deg'});$window.bind("resize.animateClouds",function(){windowWidth=$window.width();});var go=function(){cloud1Left+=cloud1Speed;if(opacity<.6){opacity+=opacitySpeed;}else{opacity=.6;}
$cloud1.transition({x:cloud1Left,opacity:opacity},framerate);if(cloud1Speed<0&&cloud1Left<(-1*cloud1Width)){cloud1Speed*=-1;}else if(cloud1Speed>=0&&cloud1Left>(windowWidth+cloud1Width)){cloud1Speed*=-1;}
requestTimeout(go,framerate);};go();},"stop":function(){}}},"starburst":{"options":{speed:.15,maxOpacity:1,minOpacity:0},"elements":{},"methods":{"init":function(){var $wrap=animations.starburst.elements.$wrap=$(".bidding-background-wrap"),$img=animations.starburst.elements.$img=$wrap.find(".background");$img.css("opacity",animations.starburst.options.minOpacity);},"start":function(callback){var $wrap=animations.starburst.elements.$wrap,$img=animations.starburst.elements.$img,options=animations.starburst.options,deg=0,opacity=options.minOpacity,onCompleteCallback=function(){if($.isFunction(callback)){callback();}},intervalHandle=0;requestTimeout(function(){intervalHandle=requestInterval(function(){$img.css({"opacity":opacity});if(opacity<options.minOpacity||opacity>options.maxOpacity){options.speed=-1*options.speed;}
if(opacity>options.maxOpacity){clearRequestInterval(intervalHandle);return;}
opacity=(opacity+options.speed);},30);},1000);},"stop":function(){}}}};for(var k in animations){var obj=animations[k],methods=obj["methods"];if(obj){if(methods&&methods["init"]){if($.isFunction(methods["init"])){obj["methods"]["init"]();}}}}
animations.starburst.methods.start();animations.clouds.methods.start();};handleAnimations();$(function(){var $bidCountWrap=$(".bid-count-wrap.active"),tl=new TimelineMax({paused:true}),wiggleDuration=0.15,wiggleDistance=10,hoverDuration=0.4;if($bidCountWrap.length){$bidCountWrap.hover(function(){var $this=$(this);TweenMax.to($this,hoverDuration,{"scale":1.05});},function(){var $this=$(this);TweenMax.to($this,hoverDuration,{"scale":1});});TweenMax.to($bidCountWrap,0,{"transformOrigin":"center 150%","transformPerspective":500});tl.to($bidCountWrap,wiggleDuration,{"x":wiggleDistance,"rotationZ":wiggleDistance/3.14}).to($bidCountWrap,wiggleDuration,{"x":-wiggleDistance,"rotationZ":-wiggleDistance/3.14}).to($bidCountWrap,wiggleDuration,{"x":wiggleDistance,"rotationZ":wiggleDistance/3.14}).to($bidCountWrap,wiggleDuration,{"x":-wiggleDistance,"rotationZ":-wiggleDistance/3.14}).to($bidCountWrap,wiggleDuration,{"x":0,"rotationZ":0});setTimeout(function(){tl.play();requestInterval(function(){tl.play(0);},10000);},1500);}});$(function(){requestTimeout(function(){var $biddingWrap=$(".bidding-wrap-outer"),$highlight=$("#highlight"),$headerImg=$("#pageHeaderImage"),biddingTop=$biddingWrap.position().top,biddingHeight=$biddingWrap.outerHeight(),biddingBottom=biddingTop+biddingHeight,highlightHeight=$highlight.outerHeight(),highlightBottom=highlightHeight,tl=new TimelineMax({paused:true}),growDuration=0.4;if($biddingWrap.length){var heightDifference=(biddingBottom-highlightBottom)-10,newHighlightHeight=highlightHeight+heightDifference;TweenMax.to([$highlight,$headerImg],growDuration,{"height":newHighlightHeight});}},500);});}};tff['admin-dash']={start:function(){$('.datepicker').datepicker();$.ajax({url:tff.baseUrl+'/api/admin/stats',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc'},dataType:'json',success:function(d){tff.debug('stat data',d);if(d.stats&&d.stats.heatmap){var hm=d.stats.heatmap;var hmd=[];for(var i=0,l=hm.length;i<l;++i){hmd.push({location:new google.maps.LatLng(hm[i].location[0],hm[i].location[1]),weight:hm[i].count});}
var m=new google.maps.Map($('#heatMap').get(0),{center:new google.maps.LatLng(36.1667,-86.7833),zoom:8,mapTypeId:google.maps.MapTypeId.HYBRID,streetViewControl:false});var ghm=new google.maps.visualization.HeatmapLayer({data:hmd});ghm.setMap(m);}},error:function(xhr){tff.nError("There was a problem retrieving some statistics. Please contact the webmast for assistance.");}});var count=$('#tabs a').length;$('#tabs a').each(function(){$(this).css('z-index',count);count--;});var activeTab=$('.tabNav a.active').attr('href');$(activeTab).addClass('contentActive').show();resizeTabContent();function resizeTabContent(){$('#tabContent').animate({'height':$('#tabContent .contentActive').height()});}
$('.tabNav a').click(function(e){e.preventDefault();var thisNav=$(this);var contentId=thisNav.attr('href');contentId=contentId.substring(1);if(!thisNav.hasClass('active')){$('.tabNav a').removeClass('active');thisNav.addClass('active');$('#tabContent').children().removeClass('contentActive').fadeOut().end().find('#'+contentId).addClass('contentActive').fadeIn();}
resizeTabContent();});}};tff['auct-view']={start:function(){var lat=$('#latitude').val();var lng=$('#longitude').val();if($.support.transition){$("html").addClass("transition");}
var $window=$(window);var inlineMaps={"init":function(){var self=inlineMaps;self.options={};self.options.lat=lat;self.options.lng=lng;self.lawnmap.init();self.streetmap.init();},"lawnmap":{"init":function(){var self=inlineMaps.lawnmap;self.options=$.extend({},inlineMaps.options);self.options.$wrap=$("#lawn_map-inline");tff.debug("lawnmap");tff.debug(self.options);if(!self.options.$wrap.length){return false;}
if(!self.options.latlng){self.options.latlng=new google.maps.LatLng(self.options.lat,self.options.lng);}
self.options.mapOptions={center:self.options.latlng,zoom:19,mapTypeId:google.maps.MapTypeId.SATELLITE,streetViewControl:false};self.options.map=new google.maps.Map(self.options.$wrap[0]);self.options.map.setOptions(self.options.mapOptions);self.options.markerOptions={map:self.options.map,position:self.options.latlng};self.options.marker=new google.maps.Marker(self.options.markerOptions);},"methods":{}},"streetmap":{"init":function(){var self=inlineMaps.streetmap;self.options=$.extend({},inlineMaps.options);self.options.$wrap=$("#street_map");tff.debug("street");tff.debug(self.options);if(!self.options.$wrap.length){return false;}
if(!self.options.latlng){self.options.latlng=new google.maps.LatLng(self.options.lat,self.options.lng);}
self.options.mapOptions={position:self.options.latlng,pov:{heading:0,pitch:0,zoom:1}};self.options.map=new google.maps.StreetViewPanorama(self.options.$wrap[0],self.options.mapOptions);self.options.markerOptions={map:self.options.map,position:self.options.latlng};self.options.marker=new google.maps.Marker(self.options.markerOptions);},"methods":{}}};inlineMaps.init();var popups={"lawnmap":{elements:{},init:function(){if(!popups.lawnmap.elements.$wrap){var $wrap=popups.lawnmap.elements.$wrap=$(".map-wrap"),$closeButton=$('<div></div>').addClass("close-button").text("X").appendTo($wrap),$openButton=popups.lawnmap.elements.$openButton=$('[href="#lawnmap"]');if(!$wrap.length){return false;}
var lat=$('#latitude').val();var lng=$('#longitude').val();$wrap.css("opacity",0).show();var latlng=new google.maps.LatLng(lat,lng),lawnMapOptions={center:latlng,zoom:19,mapTypeId:google.maps.MapTypeId.SATELLITE};var lawn_map=new google.maps.Map(document.getElementById("lawn_map"),lawnMapOptions);var markerOptions={map:lawn_map,position:latlng},marker=new google.maps.Marker(markerOptions);$wrap.hide().css("opacity",1);$closeButton.bind("click",function(){popups.lawnmap.methods.close();});}
popups.lawnmap.methods.open();},methods:{open:function(){var $wrap=popups.lawnmap.elements.$wrap,$openButton=popups.lawnmap.elements.$openButton;if(!$wrap){popups.lawnmap.init();}
$("body").bind("click.close-map",function(e){if(!$(e.target).closest(".map-wrap").length){e.preventDefault();popups.lawnmap.methods.close();}});$openButton.bind("click.close-map",function(e){e.preventDefault();popups.lawnmap.methods.close();});$wrap.css({"left":$openButton.offset().left-45,"top":$openButton.offset().top-35}).fadeIn();},close:function(){var $wrap=popups.lawnmap.elements.$wrap,$openButton=popups.lawnmap.elements.$openButton;if(!$wrap){return;}
$("body").unbind("click.close-map");$openButton.unbind("click.close-map");if(window.location.hash.replace("#","").length){var doc=document.documentElement,body=document.body;var scrollTo=(doc&&doc.scrollTop||body&&body.scrollTop||0);window.location.hash="";$(window).trigger("hashchange");if(doc){doc.scrollTop=scrollTo;}
if(body){$("body").animate({scrollTop:scrollTo},0);}}
$wrap.fadeOut();}}}};function resizeTabContent(){$('#tabContent').animate({'height':$('#tabContent .contentActive').height()});}
$('.tabNav a').click(function(e){e.preventDefault();var thisNav=$(this);var contentId=thisNav.attr('href');if(!thisNav.hasClass('active')){$('.tabNav a').removeClass('active');thisNav.addClass('active');$('#tabContent').children().removeClass('contentActive').fadeOut().end().find(contentId).addClass('contentActive').fadeIn();google.maps.event.trigger(lawn_map,'resize');google.maps.event.trigger(street_map,'resize');}
resizeTabContent();});$('#slides').slides({preload:true,generateNextPrev:true,generatePagination:false});$('#slides img').click(function(){var thisSrc=$(this).attr('src');$('#mainImage').attr('src',thisSrc).parent().attr('href',thisSrc);});var hashChanged=function(){var hash=window.location.hash.replace("#",""),hashAr=hash.split("/"),hashArLength=hashAr.length;if(popups.lawnmap.elements.$wrap&&popups.lawnmap.elements.$wrap.is(":visible")){popups.lawnmap.methods.close();}
if(popups[hashAr[0]]){popups[hashAr[0]].init();}};$window.on('hashchange.auct-view',hashChanged).on('load',function(){$window.trigger('hashchange.auct-view');});var handleAnimations=function(){var animations={"clouds":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.clouds.elements.$wrap=$(".cloud-wrap"),$img=animations.clouds.elements.$img=$wrap.find(".cloud");animations.clouds.methods.start();},"start":function(callback){var $img=animations.clouds.elements.$img,$cloud1=$img.first(),$otherClouds=$cloud1.nextAll(".cloud").hide();cloud3Left=0,cloud1Left=0,cloud1Width=300,cloud1Speed=.5,cloud3Speed=.3,opacitySpeed=.02,opacity=0,$window=$(window),windowWidth=$window.width(),framerate=60;$cloud1.addClass("cloud1").css({opacity:opacity,left:-1*cloud1Width,rotate:'.001deg'});$window.bind("resize.animateClouds",function(){windowWidth=$window.width();});var go=function(){cloud1Left+=cloud1Speed;if(opacity<.6){opacity+=opacitySpeed;}else{opacity=.6;}
$cloud1.transition({x:cloud1Left,opacity:opacity},framerate);if(cloud1Speed<0&&cloud1Left<(-1*cloud1Width)){cloud1Speed*=-1;}else if(cloud1Speed>=0&&cloud1Left>(windowWidth+cloud1Width)){cloud1Speed*=-1;}
requestTimeout(go,framerate);};go();},"stop":function(){}}},"starburst":{"options":{speed:.025,maxOpacity:1,minOpacity:0},"elements":{},"methods":{"init":function(){var $wrap=animations.starburst.elements.$wrap=$(".bidding-background-wrap"),$img=animations.starburst.elements.$img=$wrap.find(".background");},"start":function(callback){var $wrap=animations.starburst.elements.$wrap,$img=animations.starburst.elements.$img,options=animations.starburst.options,deg=0,opacity=options.minOpacity,onCompleteCallback=function(){if($.isFunction(callback)){callback();}},intervalHandle=0;intervalHandle=requestInterval(function(){$img.css({"opacity":opacity});if(opacity<options.minOpacity||opacity>options.maxOpacity){options.speed=-1*options.speed;}
if(opacity>options.maxOpacity){clearRequestInterval(intervalHandle);return;}
opacity=(opacity+options.speed);},30);},"stop":function(){}}}};for(var k in animations){var obj=animations[k],methods=obj["methods"];if(obj){if(methods&&methods["init"]){if($.isFunction(methods["init"])){obj["methods"]["init"]();}}}}
animations.starburst.methods.start();};handleAnimations();}};tff['appt-create']={start:function(){$('input.datepicker').datepicker({minDate:+1});}};tff['appt-view']={start:function(){if($.support.transition){$("html").addClass("transition");}
var $window=$(window);var $datepickers=$('input.date').datepicker();$datepickers.datepicker("option","onClose",function(){var $this=$(this);$this.trigger("blur");});var lat=$('#latitude').val();var lng=$('#longitude').val();var latlng=new google.maps.LatLng(lat,lng);lawnMapOptions={center:latlng,zoom:19,mapTypeId:google.maps.MapTypeId.SATELLITE};var lawn_map=new google.maps.Map(document.getElementById("lawn_map"),lawnMapOptions);var markerOptions={map:lawn_map,position:latlng},marker=new google.maps.Marker(markerOptions);function resizeTabContent(){$('#tabContent').animate({'height':$('#tabContent .contentActive').height()});}
var page={"init":function(){page.activity.init();page.popup.init();page.tooltip.init();},"activity":{"init":function(){if(!page.activity.elements){page.activity.elements={}}
if(!page.activity.elements.$wrap){page.activity.elements.$wrap=$(".appointment-view-wrap");page.activity.methods.initLatestAccountActivity(function(){page.activity.methods.getLatestAccountActivity();});}},"methods":{initLatestAccountActivity:function(callback){var $wrapper=page.activity.elements.$wrap.find(".latest-activity-wrap"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),liveIntervalDelay=(1000*60*5),hrefAr=location.href.split("/"),appointmentId=(hrefAr.length)?hrefAr[hrefAr.length-1].split("#")[0]:0;if(!$wrapper.length){return false;}
if(appointmentId.split("?").length>1){appointmentId=appointmentId.split("?")[0];}
if(appointmentId==0){return false;}
var setCountNotifications=function(){$wrapper.children("h2").each(function(){var $this=$(this),typeId=$this.attr("data-typeId"),curData,hrefAr=location.href.split("/"),appointmentId=(hrefAr.length)?hrefAr[hrefAr.length-1]:0,hashAr=appointmentId.split("#");if(hashAr.length){appointmentId=hashAr[0];}
if(appointmentId.split("?").length>1){appointmentId=appointmentId.split("?")[0];}
if(appointmentId==0){return false;};$.ajax({url:tff.baseUrl+'/api/notification/activity_count-appointment',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','appointmentId':appointmentId,'typeId':typeId},beforeSend:function(){},success:function(data){var $countBox=$this.find(".count-box");if(!$countBox.length){if(parseInt(data)<=0){return false;}
$countBox=$('<div class="count-box"></div>').css({"opacity":"0","margin-top":"-10px"}).html(data).appendTo($this).animate({"opacity":"1","margin-top":"0px"},300);$countBox.wrap('<span class="count-box-wrap"></span>');}else{curData=$this.find(".count-box").html();if(parseInt(data)<=0){$countBox.animate({"margin-top":"-10px","opacity":0},300,function(){$countBox.remove();});}else if(curData!=data){$countBox.animate({"margin-top":"-10px"},100,function(){$countBox.animate({"margin-top":"0px"},100);});}}
$countBox.html(data);},error:function(xhr){}});});};setCountNotifications();setInterval(function(){setCountNotifications();},liveIntervalDelay);var setNewNotifications=function(){var typeId=$listWrap.attr("data-typeId"),$firstLi=$listWrap.children("ul").children("li").first(),latestId=$firstLi.attr("data-id"),hrefAr=location.href.split("/"),appointmentId=(hrefAr.length)?hrefAr[hrefAr.length-1].split("#")[0]:0;if(appointmentId.split("?").length>1){appointmentId=appointmentId.split("?")[0];}
if(appointmentId==0){return false;};$.ajax({url:tff.baseUrl+'/api/notification/activity-appointment',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','appointmentId':appointmentId,'typeId':typeId,'firstId':latestId},beforeSend:function(){},success:function(data){var $ul=$(data),$li=$ul.find("li"),firstLiTop=75*$li.length;if(!$li.length){return false;}
$firstLi.animate({"margin-top":firstLiTop+"px"},400,function(){$li.css({"display":"none"}).insertBefore($firstLi).fadeIn(400);$firstLi.css("margin-top",0);resizeTabContent();});},error:function(xhr){}});};setInterval(function(){setNewNotifications();},liveIntervalDelay);if($.isFunction(callback)){callback();}
var scrollTimeout,scrollDelay=100;var checkScrollPos=function(){var curY=window.scrollY,windowHeight=$(window).height(),top=$listWrap.offset().top,height=$listWrap.height(),bottom=top+height,typeId=$listWrap.attr("data-typeId"),$lastItem=$listWrap.find(".notifyItem").last(),hrefAr=location.href.split("/"),appointmentId=(hrefAr.length)?hrefAr[hrefAr.length-1].split("#")[0]:0;if(appointmentId.split("?").length>1){appointmentId=appointmentId.split("?")[0];}
if(appointmentId==0){return false;};if(((windowHeight+curY)>bottom)&&!$listWrap.find(".no-more-notifications").length){$.ajax({url:tff.baseUrl+'/api/notification/activity-appointment',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','appointmentId':appointmentId,'typeId':typeId,'lastId':$lastItem.attr("data-id")},beforeSend:function(){$loader.stop().fadeIn(400);},success:function(html){$loader.stop().fadeOut(400);var $ul=$(html),$items=$ul.children("li");if($items.length){$items.insertAfter($lastItem);}else{if(!$listWrap.find(".no-more-notifications").length){$ul.appendTo($listWrap);}}
resizeTabContent();},error:function(xhr){tff.nError("There was a problem getting notifications. Please contact the webmaster for assistance.");}});}};$window.scroll(function(){clearTimeout(scrollTimeout);scrollTimeout=setTimeout(function(){checkScrollPos();},scrollDelay);});$wrapper.find(".refresh").bind("click",function(){page.activity.methods.getLatestAccountActivity();});},onHashChanged:function(){page.activity.methods.getLatestAccountActivity();},getLatestAccountActivity:function(){var $wrap=page.activity.elements.$wrap,$wrapper=$wrap.find(".latest-activity-wrap"),$listWrap=$wrapper.find(".list-wrap"),$loader=$wrapper.find(".loader"),hrefAr=location.href.split("/"),appointmentId=(hrefAr.length)?hrefAr[hrefAr.length-1].split("#")[0]:0;if(appointmentId.split("?").length>1){appointmentId=appointmentId.split("?")[0];}
if(appointmentId==0){return false;};$.ajax({url:tff.baseUrl+'/api/notification/activity-appointment',data:{api_key:'f84cbd322bc1e6acf3a0e313d4a09b3f4c69d7fc','appointmentId':appointmentId},beforeSend:function(){$listWrap.fadeOut(400);$loader.stop().fadeIn(400);},success:function(html){$loader.stop().fadeOut(400);$listWrap.html(html);$listWrap.fadeIn(400);resizeTabContent();},error:function(xhr){}});}}},"popup":{"options":{animateDuration:500,wrapSelector:".appointment-view-wrap"},"init":function(hashAr){if(!page.popup.elements){page.popup.elements={};}
var $wrap=page.popup.elements.$wrap;if(!$wrap){$wrap=page.popup.elements.$wrap=$(page.popup.options.wrapSelector);}
if(hashAr&&hashAr.length){page.popup.methods.initPopup(hashAr);}else{var $popup=$(".popup").hide();page.popup.methods.hide($popup);}},"methods":{initPopup:function(hashAr){var $wrap=page.popup.elements.$wrap,$popups=$(".popup"),$popupButtons=$wrap.find(".popup-button"),href="#"+hashAr[0],$thisPopup=$popups.filter(href);if(!hashAr.length){page.popup.methods.hide($popups);return;}
page.popup.methods.show($thisPopup.first());},show:function($popups,callback){if(!$popups.length){return;}
$popups.each(function(){var $this=$(this),$modal=tff.showModal("",$this,{beforeOpen:function(m){m.find('.modalOk').hide();m.find('.modalCancel').hide();},afterClose:function(m){var $popup=m.find(".popup"),href=$popup.attr("id"),$wrap=$(page.popup.options.wrapSelector),$link=$wrap.find('[href="#popup/'+href+'"]');$popup.insertAfter($link).hide();},afterRemove:function(){var $modal=$(".modal");if(!$modal.length){var doc=document.documentElement,body=document.body;var scrollTo=(doc&&doc.scrollTop||body&&body.scrollTop||0);window.location.hash="";$(window).trigger("hashchange");if(doc){doc.scrollTop=scrollTo;}
if(body){$("body").animate({scrollTop:scrollTo},0);}}}});$datepicker=$modal.find('input.date').datepicker({minDate:+1});$datepicker.datepicker("option","onClose",function(){var $this=$(this);$this.trigger("blur");});$this.show();$modal.trigger("open");});},hide:function($popups,callback){if(!$popups.length){return;}
$popups.trigger("close.modal");},onHashChanged:function(hashAr){page.popup.init(hashAr);},}},"tooltip":{"options":{animateDuration:500,wrapSelector:".appointment-view-wrap",tooltipSelector:".tooltip"},"init":function(hashAr){if(!page.tooltip.elements){page.tooltip.elements={};}
var $wrap=page.tooltip.elements.$wrap;if(!$wrap){$wrap=page.tooltip.elements.$wrap=$(page.tooltip.options.wrapSelector);$wrap.find(page.tooltip.options.tooltipSelector).addClass("active");}
if(hashAr&&hashAr.length){page.tooltip.methods.initTooltip(hashAr);}else{page.tooltip.methods.hide($wrap.find(page.tooltip.options.tooltipSelector));}},"methods":{initTooltip:function(hashAr){var $wrap=page.tooltip.elements.$wrap,$tooltips=$wrap.find(page.tooltip.options.tooltipSelector),$tooltipButtons=$wrap.find(".tooltip-button"),href="#"+hashAr[0],$thisTooltip=$tooltips.filter(href);if(!hashAr.length){page.tooltip.methods.hide($tooltips);return;}
page.tooltip.methods.show($thisTooltip);},show:function($tooltip,callback){if(!$tooltip.length){return;}
var $wrap=page.tooltip.elements.$wrap,$tooltips=$wrap.find(page.tooltip.options.tooltipSelector),$this=$tooltip,tooltipWidth=$this.width(),$infoWrap=$(".cust-info-wrap"),onCompleteCallback=function(){$tooltip.addClass("active");$("body").on("click.tooltip",function(e){var $target=$(e.target);if($target.closest('[href="#tooltip/'+$tooltip.attr("id")+'"]').length){e.preventDefault();}
if(!$target.closest(".tooltip-wrap").length){var doc=document.documentElement,body=document.body;var scrollTo=(doc&&doc.scrollTop||body&&body.scrollTop||0);window.location.hash="";$(window).trigger("hashchange");if(doc){doc.scrollTop=scrollTo;}
if(body){$("body").animate({scrollTop:scrollTo},0);}}});if($.isFunction(callback)){callback($this);}};page.tooltip.methods.hide($tooltips.not($tooltip));$this.closest(".tooltip-wrap").css({"right":$window.width()-($infoWrap.offset().left+$infoWrap.width()),"left":"auto","opacity":0,"z-index":100,"margin-top":"20px"}).show();$this.show();TweenMax.to($this.closest(".tooltip-wrap"),.3,{"marginTop":"10px","opacity":1,onComplete:function(){onCompleteCallback();}});var $slides=$tooltip.find("#slides");if($slides.length&&!$slides.is(".initialized")){$slides.addClass("initialized").slides({preload:true,generateNextPrev:true,generatePagination:false});$('#slides img').click(function(){var thisSrc=$(this).attr('src');$('#mainImage').attr('src',thisSrc).parent().attr('href',thisSrc);});}},hide:function($tooltips,callback){$tooltips.each(function(){var $this=$(this);if(!$this.is(".active")){return;}
$("body").off("click.tooltip");TweenMax.to($this.closest(".tooltip-wrap"),.3,{"marginTop":"20px","opacity":0,onComplete:function(){$this.hide().removeClass("active");if($.isFunction(callback)){callback($this);}}});});},onHashChanged:function(hashAr){page.tooltip.init(hashAr);},}}};var hashChanged=function(){var hash=window.location.hash.replace("#",""),hashAr=hash.split("/"),hashArLength=hashAr.length,thisItem="",$thisTab,$thisNav,hashChangeDelay=0;if(page[hashAr[0]]){if(!$("body").is(".animation-complete")){hashChangeDelay=2000;}
setTimeout(function(){thisItem=hashAr.shift();page[thisItem].methods.onHashChanged(hashAr);},hashChangeDelay);}else{page.init();}};$window.on('hashchange.appt-view',hashChanged).on('load',function(){$window.trigger('hashchange.appt-view');});var handleAnimations=function(){var animations={"clouds":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.clouds.elements.$wrap=$(".cloud-wrap"),$img=animations.clouds.elements.$img=$wrap.find(".cloud");animations.clouds.methods.start();},"start":function(callback){var $img=animations.clouds.elements.$img,$cloud1=$img.first(),$otherClouds=$cloud1.nextAll(".cloud").hide();cloud3Left=0,cloud1Left=0,cloud1Width=300,cloud1Speed=.5,cloud3Speed=.3,opacitySpeed=.02,opacity=0,$window=$(window),windowWidth=$window.width(),framerate=60;$cloud1.addClass("cloud1").css({opacity:opacity,left:-1*cloud1Width,rotate:'.001deg'});$window.bind("resize.animateClouds",function(){windowWidth=$window.width();});var go=function(){cloud1Left+=cloud1Speed;if(opacity<.6){opacity+=opacitySpeed;}else{opacity=.6;}
$cloud1.transition({x:cloud1Left,opacity:opacity},framerate);if(cloud1Speed<0&&cloud1Left<(-1*cloud1Width)){cloud1Speed*=-1;}else if(cloud1Speed>=0&&cloud1Left>(windowWidth+cloud1Width)){cloud1Speed*=-1;}
requestTimeout(go,framerate);};go();},"stop":function(){}}},"grassRear":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.grassRear.elements.$wrap=$(".rear-grass");$wrap.css({"top":"100%"});},"start":function(callback){var $wrap=animations.grassRear.elements.$wrap,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};TweenMax.to($wrap,.5,{"top":"78%",ease:Back.easeOut,onComplete:function(){onCompleteCallback();}});},"stop":function(){}}},"grassFront":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.grassFront.elements.$wrap=$(".front-grass");$wrap.css({"bottom":"-15%"});},"start":function(callback){var $wrap=animations.grassFront.elements.$wrap,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};TweenMax.to($wrap,.5,{"bottom":"-1%",ease:Back.easeOut,onComplete:function(){onCompleteCallback();}});},"stop":function(){}}},"house":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.house.elements.$wrap=$(".house-wrap"),$house=animations.house.elements.$house=$wrap.find(".house");$house.css({"transform":"rotateX(100deg)"});},"start":function(callback){var $wrap=animations.house.elements.$wrap,$house=animations.house.elements.$house,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};TweenMax.to($house,.8,{"rotationX":"0deg",onComplete:function(){onCompleteCallback();}});},"stop":function(){}}},"mower":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.mower.elements.$wrap=$(".mower-wrap"),$mowerLeft=animations.mower.elements.$mowerLeft=$wrap.find(".mower.left"),$mowerRight=animations.mower.elements.$mowerRight=$wrap.find(".mower.right");$mowerRight.css({"position":"relative","left":"-200px"});},"start":function(callback){var $wrap=animations.mower.elements.$wrap,$mowerRight=animations.mower.elements.$mowerRight,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};TweenMax.to($mowerRight,1,{"left":$window.width()*.25,onComplete:function(){onCompleteCallback();}});},"stop":function(){}}},"flower":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.flower.elements.$wrap=$(".flower-wrap"),$flower=animations.flower.elements.$flower=$wrap.find(".flower");$flower.css({"position":"relative","top":"100px"});},"start":function(callback){var $wrap=animations.flower.elements.$wrap,$flower=animations.flower.elements.$flower,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};TweenMax.to($flower,.8,{"top":0,onComplete:function(){onCompleteCallback();}});},"stop":function(){}}},"infoVendor":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.infoVendor.elements.$wrap=$(".vendor-info-wrap");$wrap.css({"margin-top":"-50px","margin-left":"-150px","opacity":0,"display":"none"});},"start":function(callback){var $wrap=animations.infoVendor.elements.$wrap,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};$wrap.css({"left":animations.mower.elements.$mowerRight.offset().left+(animations.mower.elements.$mowerRight.width()/2)}).show();TweenMax.to($wrap,.3,{"marginTop":-5,"opacity":1,onComplete:function(){onCompleteCallback();}});},"stop":function(){}}},"infoCustomer":{"options":{},"elements":{},"methods":{"init":function(){var $wrap=animations.infoCustomer.elements.$wrap=$(".cust-info-wrap");$wrap.css({"margin-top":"-50px","margin-left":"-150px","opacity":0,"display":"none"});},"start":function(callback){var $wrap=animations.infoCustomer.elements.$wrap,onCompleteCallback=function(){if($.isFunction(callback)){callback();}};$wrap.css({"left":animations.house.elements.$wrap.offset().left+(animations.house.elements.$wrap.width()/2)}).show();TweenMax.to($wrap,.3,{"marginTop":-5,"opacity":1,onComplete:function(){onCompleteCallback();}});},"stop":function(){}}},"ratingStars":{"options":{starPosInc:18,starMinPos:-180,starRevealDuration:50},"elements":{},"methods":{"init":function(){var $wrap=animations.ratingStars.elements.$wrap=$(".star-rating");starMinPos=$wrap.css("background-position");starMinPos=parseInt(starMinPos.split(" ")[1].replace("px",""));animations.ratingStars.options.starMinPos=starMinPos;$wrap.css({"background-position":"0px 0px"});},"start":function(callback){var $wrap=animations.ratingStars.elements.$wrap,options=animations.ratingStars.options,onCompleteCallback=function(){if($.isFunction(callback)){callback();}},currentStarPos=0,initStars=function(){setTimeout(function(){currentStarPos-=options.starPosInc;if(currentStarPos>=options.starMinPos){$wrap.css({"background-position":"0px "+currentStarPos+"px"});initStars();}else{onCompleteCallback();}},options.starRevealDuration);};initStars();},"stop":function(){}}}};for(var k in animations){var obj=animations[k],methods=obj["methods"];if(obj){if(methods&&methods["init"]){if($.isFunction(methods["init"])){obj["methods"]["init"]();}}}}
setTimeout(function(){animations.grassFront.methods.start();animations.grassRear.methods.start(function(){animations.flower.methods.start(function(){});animations.mower.methods.start(function(){animations.infoVendor.methods.start(function(){requestTimeout(function(){animations.ratingStars.methods.start(function(){$("body").addClass("animation-complete");});},250);});});animations.house.methods.start(function(){animations.infoCustomer.methods.start(function(){});});});},500);};handleAnimations();}};tff['user-edit']={start:function(){}};tff['notify']={start:function(){function stepIn(next,prev){$(next).animate({left:'0px',opacity:1}).addClass('current');}
function stepOut(next,prev){$(prev).animate({left:'20px',opacity:0}).removeClass('current');}
function animHeight(h){$('#NotificationArea').animate({height:(h)+'px'});}
$('.notificationList.current').css({'left':'0'});$('#NotificationNav a').click(function(e){e.preventDefault();var next=$(this).attr('href');var h=$('#NotificationArea '+next).height();var prev=$('#NotificationNav a.active').attr('href');if(next!=prev){$('#NotificationNav a').removeClass('active').end().find('a[href='+next+']').addClass('active');animHeight(h);stepOut(next,prev);stepIn(next,prev);}});}};tff['payment']={start:function(){$('.datepicker').datepicker();}};;tff['co-vet']={player:null,playerReady:false,start:function(){tff['co-vet']._loadVideo();tff['co-vet']._addButtonControls();tff['co-vet']._startSurvey();tff['co-vet']._handleFormSubmit();$('#company_vet_form fieldset').hide().filter(':first').show();var p=$('#new_ServicePostal');var lat=$('#new_ServiceLat');var lng=$('#new_ServiceLng');$('#company_vet_form').on('change','#new_ServicePostal',function(){if(p.val().length){tff.geocodeAddress(p.val(),function(geo){if(geo&&geo.length==2){lat.val(geo[0]);lng.val(geo[1]);}});}});$datepickers=$('input.date').datepicker();$datepickers.datepicker("option","onClose",function(){var $this=$(this);$this.trigger("blur");});$datepickers.each(function(){var $this=$(this);$this.datepicker("option","minDate",null);$this.datepicker("option","changeYear",true);$this.datepicker("option","changeMonth",true);});},_removeVideoCookie:function(){$.cookie("gp-haswatchedvettingvideo",null);},_setVideoCookie:function(){if(!$.cookie("gp-haswatchedvettingvideo")){$.cookie("gp-haswatchedvettingvideo",true);}},_hasVideoCookie:function(){return!!$.cookie("gp-haswatchedvettingvideo");},_loadVideo:function(){if(!/^https?\:\/\/test\./.test(tff.baseUrl)||tff.requestParams.debug==1){var player;window.onYouTubeIframeAPIReady=function(){player=new YT.Player('standardsVideoHolder',{height:'315',width:'420',videoId:'gYMcak7GyZM',events:{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},playerVars:{rel:0,controls:0}});}
function onPlayerReady(event){tff["co-vet"].playerReady=true;$(".youtube-error").hide();}
var done=false;function onPlayerStateChange(event){if(event.data===0||tff['co-vet']._hasVideoCookie()){$('#videoButtonNote').hide();$('#videoButtonNext').show();tff['co-vet']._setVideoCookie();}else{$('#videoButtonNote').show();$('#videoButtonNext').hide();}}
function stopVideo(){player.stopVideo();}}},_addButtonControls:function(){$('#company_vet_form').on('click','input[type=button]',function(e){var f=$(this).parents('fieldset');var n=null;if($(this).hasClass('forward')){if(f.index()<f.siblings('fieldset').length){n=f.hide().next().show();$("iframe").hide();n.find("iframe").show();}}else if($(this).hasClass('back')){if(f.index()>0){n=f.hide().prev().show();$("iframe").hide();n.find("iframe").show();}}else if($(this).hasClass('prevQ')){var q=$(this).parents('.questionBox');if(q.index()>0){n=q.hide().prev().show();}}else if($(this).hasClass('nextQ')){var q=$(this).parents('.questionBox');if(q.index()<q.siblings('.questionBox').length){n=q.hide().next().show();}}
if(n.find('.ketchup-error-container:has(li.ketchupMessage):first').length){n.find('.ketchup-error-container:has(li.ketchupMessage)').each(function(){tff.ketchupOptions.showContainer($(this));});}});},_startSurvey:function(){var qs=$('#standardsSurvey .questionBox');qs.each(function(i){var b="<div class='buttons'>";if(i===0){b+="<input type='button' class='back button' value='Go back' />";}
if(i>0){b+="<input type='button' class='prevQ button' value='Previous Question' />";}
if(i<(qs.length-1)){b+="<input type='button' class='nextQ button' value='Next Question' />";}
if(i==(qs.length-1)){b+="<input type='button' class='forward button' value='Go to Step 4 of 5' />";}
b+="</div>";$(this).append(b);}).filter(':first').show();},_handleFormSubmit:function(){$('#company_vet_form').submit(function(){var f=$(this);setTimeout(function(){var steps=$('fieldset:has(.ketchup-validation-error)',f);if(steps.length){if(steps.length>1){tff.nInfo("There are multiple steps which require your attention!");}
$('fieldset',f).hide();var first=steps.filter(':first').show();first.find('.ketchup-error-container:has(li.ketchupMessage)').each(function(){tff.ketchupOptions.showContainer($(this));});var bq=$('.questionBox .ketchup-validation-error:first');if(bq&&bq.length){$('.questionBox').hide();bq.parents('.questionBox').show();}}},100);});}};